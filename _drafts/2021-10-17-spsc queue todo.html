---
layout: post
title: spsc queue todo
date: '2021-10-17T22:58:00.001+09:00'
author: jeremyko
tags:
modified_time: '2021-10-17T22:58:16.863+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-6437147151325906002
---

<p>&nbsp;https://github.com/cameron314/readerwriterqueue</p><p>이것과 비교.. </p><p>성능이 많이 딸림... ㅜㅜ</p><p><br /></p><p>TODO :&nbsp; 복사를 하지 않게?</p><p>list 구조? &nbsp; enqueue 시 메모리를 할당하고<br /></p><p>~/Downloads/mydev/readerwriterqueue/benchmarks# ./benchmarks<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |----------------&nbsp; Min ---------------------------|----------------- Max ---------------------------|----------------- Avg ---------------------------|<br />Benchmark&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; RWQ&nbsp;&nbsp; |&nbsp; BRWCB&nbsp; |&nbsp; SPSC&nbsp;&nbsp; |&nbsp; Folly&nbsp; | kojh&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; RWQ&nbsp;&nbsp; |&nbsp; BRWCB&nbsp; |&nbsp; SPSC&nbsp;&nbsp; |&nbsp; Folly&nbsp; |&nbsp; kojh&nbsp;&nbsp; |&nbsp;&nbsp; RWQ&nbsp;&nbsp; |&nbsp; BRWCB&nbsp; |&nbsp; SPSC&nbsp;&nbsp; |&nbsp; Folly&nbsp; |&nbsp; kojh&nbsp;&nbsp; | xSPSC | xFolly <br />------------------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-------+-------+<br />Raw add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0.0004s | 0.0013s | 0.0002s | 0.0001s | 0.0014s | 0.0004s | 0.0014s | 0.0002s | 0.0001s | 0.0014s | 0.0004s | 0.0013s | 0.0002s | 0.0001s | 0.0014s | 0.40x | 0.20x3.47x<br />Raw remove&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Raw empty remove&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Single-threaded&nbsp;&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Mostly add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Mostly remove&nbsp;&nbsp;&nbsp;&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Heavy concurrent&nbsp; | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br />Random concurrent | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.0000s | 0.00x | 0.00x0.00x<br /><br />Average ops/s:<br />&nbsp;&nbsp;&nbsp; ReaderWriterQueue:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 30.14 million<br />&nbsp;&nbsp;&nbsp; BlockingReaderWriterCircularBuffer: 9.17 million<br />&nbsp;&nbsp;&nbsp; SPSC queue:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 65.18 million<br />&nbsp;&nbsp;&nbsp; Folly queue:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 148.80 million<br />&nbsp;&nbsp;&nbsp; kojh queue:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8.81 million<br /></p><p><br /></p>