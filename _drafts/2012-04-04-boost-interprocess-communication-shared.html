---
layout: post
title: boost - Interprocess Communication, Shared Memory (1/3)
date: '2012-04-04T09:17:00.003+09:00'
author: jeremyko
tags:
- cpp
- boost
modified_time: '2016-12-31T15:20:36.710+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-1083726992783576352
blogger_orig_url: https://jeremyko.blogspot.com/2012/04/boost-interprocess-communication-shared.html
---

<span style="background-color: white; color: #555555; font-family: Arial,helvetica,sans-serif; font-size: small; line-height: 18px; text-align: left;">Copyright © 2008-2010 Boris Schäling</span><br /><div style="font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: Arial,helvetica,sans-serif; font-size: small;">이글은 다음 사이트 내용을 참조로 작성되었고. 개인적인 Study 목적으로 작성되었습니다.</span></div><div style="line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: Arial,helvetica,sans-serif; font-size: small;">The contents of this page are constructed with reference to the following site and&nbsp;</span><span style="background-color: white; color: #999999; font-family: Arial,helvetica,sans-serif; font-size: small;">translated just for personal academic study only</span><span style="background-color: white; color: #999999; font-family: Arial,helvetica,sans-serif; font-size: small;">. &nbsp;</span><span style="font-size: small;"><b style="font-family: arial,helvetica,sans-serif;"><a href="http://en.highscore.de/cpp/boost/" style="text-decoration: none;" target="_blank"><span style="background-color: white; color: #999999; font-family: Arial,helvetica,sans-serif;">http://en.highscore.de/cpp/boost/</span></a></b></span></div><span style="font-size: small;"><br /></span><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><div style="background-color: #e4e4e4;"><span style="font-family: arial,helvetica,sans-serif; font-size: small;"></span></div></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/shared_memory_object.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">int main()</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">{</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp; boost::interprocess::shared_memory_object</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-size: small;"><span style="font-family: Arial,helvetica,sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">    </span>shdmem(<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::open_or_create,&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif;">"Highscore",</span></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp; boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>shdmem.truncate(1024);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; shdmem.get_name() &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::interprocess::offset_t size;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>if (shdmem.get_size(size))</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp; <span style="white-space: pre;">&nbsp;   </span>std::cout &lt;&lt; size &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">}</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><b><span style="color: #006699;">boost::interprocess::shared_memory_object</span></b>&nbsp;생성자는 3개 인자를 필요로 한다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">첫번째는 생성할것인지 기존것을 open 할지를 결정한다.&nbsp;</span><br /><a name='more'></a></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">예제에서&nbsp;</span><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">boost::interprocess::open_or_create 은 공유메모리가 없으면 생성하고, 존재하면 그것을 연다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">두번째 인자는 공유메모리에 대한 고유한 이름이다. 이 이름으로 기존 생성된것을 열수있다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">세번째는 공유메모리에 접근하는 방식을 나타내는데, boost::interprocess::read_write은&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">어플리케이션이 읽고, 쓰는것이 가능함을 의미한다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">기존적으로 생성되는 메모리 사이즈는 0인데, 이를 조정하기위해서는 truncate()를 호출하면서&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">원하는 크기를 넘긴다 (위 예제에서는 1,024 bytes를 할당했다).&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">truncate()는 boost::interprocess::read_write 이 사용된 경우에만 사용가능하고,&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">공유메모리의 크기를 조정시에는 truncate() 연속적으로 호출될수 있다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">공유메모리는 서로 다른 어플리케이션간의 데이터 교환을 위해 사용되어지므로&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">각 어플리케이션은 공유메모리와 자신의 메모리 공간을 일치시켜야 하는데&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">이때 boost::interprocess::mapped_region 클래스가 사용된다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">공유메모리 접근에 두개의 클래스가 사용되는것이 이상할수 있지만&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">boost::interprocess::mapped_region 클래스는 특정 어플리케이션의 주소공간에&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">다른 객체들을 맵핑시키는데도 사용될수 있다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">예를 들어, boost::interprocess::file_mapping는 특정 파일을 위한 공유메모리를&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">나타낸다. 그러므로 이 타입의 객체는 파일에 해당된다. 이 객체에 쓰여지는 데이터는&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">자동적으로 상응하는 물리적 파일에 저장된다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">boost::interprocess::file_mapping는 전체 파일을 로드하지 않고 한 부분만을&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">주소공간과 맵핑시키기 위해서&nbsp;</span><span style="font-size: small;"><b style="background-color: white; font-family: Arial,helvetica,sans-serif;"><span style="color: #006699;">boost::interprocess::mapped_region&nbsp;</span></b></span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">를 사용한다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">덕분에 수 기가바이트 파일도 32비트 OS환경에서 공유메모리로 사용될수 있다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/shared_memory_object.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/mapped_region.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">int main()</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">{</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::shared_memory_object shdmem(</span><br /><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boost::interprocess::open_or_create,<span class="Apple-tab-span" style="white-space: pre;"> </span>"Highscore", boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>shdmem.truncate(1024);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::interprocess::mapped_region region(shdmem, boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>std::cout &lt;&lt; std::hex &lt;&lt; "0x" &lt;&lt; region.get_address() &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; std::dec &lt;&lt; region.get_size() &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::interprocess::mapped_region region2(shdmem, boost::interprocess::read_only);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; std::hex &lt;&lt; "0x" &lt;&lt; region2.get_address() &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; std::dec &lt;&lt; region2.get_size() &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">}</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">boost::interprocess::mapped_region 클래스를 사용하려면&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">boost/interprocess/mapped_region.hpp를 include한다.</span><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">그리고 생성자 첫번째 인자로 boost::interprocess::shared_memory_object 객체가&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">전달되어야 한다. 두번째 인자는 접근 권한을 나타낸다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">위 예제에서 Highscore 이름의 공유메모리는 2번 주소공간에 맵핑되었다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">get_size() 는 맵핑된 공간 크기를 나타내는 1024값을 각 boost::interprocess::mapped_region&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">객체에 대해서 돌려주지만, get_address() 는 틀린값을 리턴한다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">다음은 공유메모리를 통해서 숫자를 읽고 쓰는 예제이다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/shared_memory_object.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/mapped_region.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">int main()</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">{</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><span style="white-space: pre;"> &nbsp;   </span>boost::interprocess::shared_memory_object</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><span class="Apple-tab-span" style="white-space: pre;">     </span>shdmem(<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::open_or_create,</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><span class="Apple-tab-span" style="white-space: pre;">                      </span>"Highscore", boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>shdmem.truncate(1024);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>boost::interprocess::mapped_region region(shdmem, boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>int *i1 = static_cast&lt;int*&gt;(region.get_address());</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>*i1 = 99;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>boost::interprocess::mapped_region region2(shdmem, boost::interprocess::read_only);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>int *i2 = static_cast&lt;int*&gt;(region2.get_address());</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>std::cout &lt;&lt; *i2 &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">}</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">위 예제처럼 동일 어플리케이션에서 여러개의 boost::interprocess::mapped_region 객체가&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">사용될 경우는 별로 없다. 단지 예를 든것 뿐이다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">공유메모리를 삭제하기 위해서는 정적 함수 remove() 를 이용한다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">한편, RAII개념의 </span><span style="font-size: small;"><b style="background-color: white; font-family: Arial,helvetica,sans-serif;"><span style="color: #006699;">boost::interprocess::remove_shared_memory_on_destroy</span></b></span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;존재하는데&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">객체 생성시 인자로서 기 존재하는 공유메모리의 이름을 전달하면,&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">이 객체가 파괴될때 소멸자에서 가지고 있던 공유메모리도 함께 제거해준다.</span><br /><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/shared_memory_object.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">int main()</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">{</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>bool removed = boost::interprocess::shared_memory_object::remove("Highscore");</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; removed &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">}</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">만약 remove()가 호출되지 않는다면, 어플리케이션이 종료되어도 공유메모리는 삭제되지 않는다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">유닉스나 리눅스의 경우는 시스템 재시작시 자동으로 공유메모리가 삭제되지만,&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">윈도우나 mac 의 경우는 remove() 호출이 없다면 시스템 재시작후에도&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">공유메모리는 파일로서 계속 존재하고, 재사용할수 있다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">윈도우의 경우는 공유메모리를 사용하던 어플리케이션에서 최종 사용자가 종료될때&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">자동으로 공유메모리를 삭제할수 있는데, 이를 위해서&nbsp;</span><span style="font-size: small;"><b style="background-color: white; font-family: Arial,helvetica,sans-serif;"><span style="color: #006699;">boost::interprocess::windows_shared_memory</span></b></span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;클래스를 사용한다.</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/windows_shared_memory.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;boost/interprocess/mapped_region.hpp&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">int main()</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">{</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::windows_shared_memory</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; <span class="Apple-tab-span" style="white-space: pre;">    </span>shdmem(<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::open_or_create,&nbsp;</span><span style="background-color: white; color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">"Highscore",&nbsp;</span><span style="background-color: white; color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">boost::interprocess::read_write,&nbsp;</span><span style="background-color: white; color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">1024);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::interprocess::mapped_region region(shdmem, boost::interprocess::read_write);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>int *i1 = static_cast&lt;int*&gt;(region.get_address());</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>*i1 = 99;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::interprocess::mapped_region region2(shdmem, boost::interprocess::read_only);</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>int *i2 = static_cast&lt;int*&gt;(region2.get_address());</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>std::cout &lt;&lt; *i2 &lt;&lt; std::endl;</span></div><div style="background-color: white; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial,helvetica,sans-serif; font-size: small;">}</span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial,helvetica,sans-serif; line-height: 18px; text-align: left;"><span style="font-family: Arial,helvetica,sans-serif; font-size: small;">이경우 truncate() 메서드를 제공하지 않는다. 대신 입력인자로 사이즈를 전달한다.&nbsp;</span><span style="background-color: white; font-family: Arial,helvetica,sans-serif; font-size: small;">그리고 당연하지만, 포터블하지 않다.</span></div>