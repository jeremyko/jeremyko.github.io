---
layout: post
title: socket backlog test
date: '2016-07-24T23:42:00.000+09:00'
author: jeremyko
tags:
modified_time: '2016-07-24T23:42:57.692+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-1956028799582584040
blogger_orig_url: https://jeremyko.blogspot.com/2016/07/socket-backlog-test.html
---

<br />왜 동작방식이 차이가 나는가???<br />http://tmtms.hatenablog.com/entry/2014/08/06/tcp-established<br />http://veithen.github.io/2014/01/01/how-tcp-backlog-works-in-linux.html<br /><br />* BSD방식은 큐 하나에 2개의 상태를 보관<br /><br />* Linux&nbsp; <br />2개의 큐를 사용 (incomplete, completed) --&gt; SYN queue (system wide), accept queue(application) <br />리눅스에서 만약 accept queue 가 full인 상황에서 SYN queue로부터 이동이 필요하다면 어떤 일이 벌어질까? <br />즉 ACK 를 받아서 3-way handshake 가 완료되는 경우라면?<br />/proc/sys/net/ipv4/tcp_abort_on_overflow =1 로 설정되지 않으면 아무일도 하지 않는다(즉 해당 ACK패킷을 무시한다)...<br />그런데 서버입장에서 이 ACK가 무시된 경우에는 타이머에 의해 다시 SYN/ACK가 재전송 될것이다(/proc/sys/net/ipv4/tcp_synack_retries 갯수만큼큼).<br />그럼 클라이언트는 자신이 보낸 ACK가 누락된것으로 판단하고 다시 ACK 를 전송하게 된다. tcpdump 에서 TCP Dup ACK&nbsp; 로 확인할수 있다.<br />한편 클라이언트 입장에서는 SYN/ACK를 받은 이후에는 ESTABLISHED상태가 된다. 이때 client가 먼저 보낸 데이터가 있다면 ACK 재전송과 마찬가지로 해당 데이터도 재전송된다.<br />만략 서버에서 오는 데이터를 먼저 기다리는 구조라면, client에서는 ESTABLISHED 상태이나 서버에서는 해당 연결을 알지 못하는 상태가 된다. (half open connection)<br />accept queue 가 full인 상태라면 커널이 syn queue 에 저장되지 않도록 SYN 패킷을 DROP시킬수도 있다.<br />리눅스는 큐를 2개로 분리함으로서 트래픽특성에 따른 시스템 관리측면과 어플리케이션 관점을 별개로 생각할수있게 하였다..<br />어플리케이션의 입장에서는 accept 를 최대한 빨리 호출해서 accept queue 가 차지 않게 해야한다.<br /><br />sysctl -w ﻿net.core.somaxconn=1024 (리눅스)<br />sysctl -w kern.ipc.somaxconn=1024 (OS X) <br />로 설정 후 if(listen( hsock, 1000) == -1 ) 하면 쓰레드 200개 해도 성공.. SOMAXCONN 128이지만...<br /><br />if(listen( hsock, 5) == -1 ) 인경우...<br /><br />///////////////// OS X<br />연결은 성공이지만 데이터를 보내고 받는 시점에 연결이 reset된것으료 표시된다......!!!!??<br />kojh-mb-pro:socket_multithread_exemple kojunghyun$ ./LinServer <br />max concurrent socket connection = 128<br />+++Received connection from 127.0.0.1 client cnt=1<br />+++Received connection from 127.0.0.1 client cnt=2<br />+++Received connection from 127.0.0.1 client cnt=3<br />+++Received connection from 127.0.0.1 client cnt=4<br />+++Received connection from 127.0.0.1 client cnt=5<br /><br /><br />kojh-mb-pro:socket_multithread_exemple kojunghyun$ ./LinClient 10<br />total thread =10<br />connected [1]!! elapsed: 0.001033<br />connected [2]!! elapsed: 0.001039<br />connected [3]!! elapsed: 0.001037<br />connected [4]!! elapsed: 0.001050<br />connected [5]!! elapsed: 0.001053<br />connected [6]!! elapsed: 0.001602<br />connected [7]!! elapsed: 0.001506<br />connected [8]!! elapsed: 0.001530<br />connected [9]!! elapsed: 0.001529<br />connected [10]!! elapsed: 0.001529<br />Error receiving data Connection reset by peer<br />Error receiving data Connection reset by peer<br />Error receiving data Connection reset by peer<br />Error receiving data Connection reset by peer<br />Error receiving data Connection reset by peer<br />--OK Recieved bytes 694<br />--OK Recieved bytes 694<br />--OK Recieved bytes 694<br />--OK Recieved bytes 694<br />--OK Recieved bytes 694<br />----------- total test elapsed: 0.004150<br /><br />DESCRIPTION<br />&nbsp;&nbsp;&nbsp;&nbsp; Creation of socket-based connections requires several operations.&nbsp; First, a socket is created with socket(2).&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp; Next, a willingness to accept incoming connections and a queue limit for incoming connections are specified with listen().&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp; Finally, the connections are accepted with accept(2).&nbsp; The listen() call applies only to sockets of type SOCK_STREAM.<br /><br />&nbsp;&nbsp;&nbsp;&nbsp; The backlog parameter defines the maximum length for the queue of pending connections.&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp; If a connection request arrives with the queue full, the client may receive an error with an indication of<br />&nbsp;&nbsp;&nbsp;&nbsp; ECONNREFUSED.&nbsp; Alternatively, if the underlying protocol supports retransmission, <br />&nbsp;&nbsp;&nbsp;&nbsp; the request may be ignored so that retries may succeed.<br /><br /><br /><br />//////////////////////// LINUX<br />**** tcpdump 보면 이상내역 없다.. 정상적으로 연결 이후 전송 후 종료..... ---&gt; 리눅스에서는 backlog 설정에 따른 비정상 동작이 없다??????/<br />﻿net.ipv4.tcp_max_syn_backlog = 128<br />net.ipv4.tcp_syncookies = 1<br /><br /><br />﻿The&nbsp; behavior&nbsp; of the backlog argument on TCP sockets changed with Linux 2.2.&nbsp; <br />Now it specifies the queue length for completely established sockets waiting to be accepted, instead of the <br />number of incomplete connection requests.&nbsp; The maximum<br />length of the queue for incomplete sockets can be set using /proc/sys/net/ipv4/tcp_max_syn_backlog.&nbsp; <br />When syncookies are enabled there is no logical maximum length and this setting is ignored.&nbsp; See tcp(7) for more information.<br /><br />If the backlog argument is greater than the value in /proc/sys/net/core/somaxconn, then it is silently truncated <br />to that value; the default value in this file is 128.&nbsp; In kernels before 2.4.25, this limit was a hard coded&nbsp; value,&nbsp; <br />SOMAXCONN,<br />with the value 128.<br /><br />//backlog = 5 인데 왜?????<br />﻿jeremyko@jeremyko-VirtualBox:~/mydev/socket_test/socket_multithread_exemple$ ./LinServer <br />max concurrent socket connection = 128<br />+++Received connection from 127.0.0.1 client cnt=1<br />+++Received connection from 127.0.0.1 client cnt=2<br />+++Received connection from 127.0.0.1 client cnt=3<br />+++Received connection from 127.0.0.1 client cnt=4<br />+++Received connection from 127.0.0.1 client cnt=5<br />+++Received connection from 127.0.0.1 client cnt=6<br />+++Received connection from 127.0.0.1 client cnt=7<br />+++Received connection from 127.0.0.1 client cnt=8<br />+++Received connection from 127.0.0.1 client cnt=9<br />+++Received connection from 127.0.0.1 client cnt=10<br /><br /><br />﻿jeremyko@jeremyko-VirtualBox:~/mydev/socket_test/socket_multithread_exemple$ ./LinClient 10<br />total thread =10<br />connected [1]!! elapsed: 0.000403<br />connected [2]!! elapsed: 0.000137<br />connected [3]!! elapsed: 0.000109<br />connected [4]!! elapsed: 0.000092<br />connected [5]!! elapsed: 0.000525<br />connected [6]!! elapsed: 0.000358<br />connected [7]!! elapsed: 0.000237<br />connected [8]!! elapsed: 0.000539<br />connected [9]!! elapsed: 0.000577<br />connected [10]!! elapsed: 0.997977<br />----------- total test elapsed: 0.999250 ----&gt; !!!!<br /><br />//listen (..., somaxconn) 인 경우엔 처리시간이 빨라진다...!!<br /><br />﻿jeremyko@jeremyko-VirtualBox:~/mydev/socket_test/socket_multithread_exemple$ ./LinClient 10<br />total thread =10<br />connected [1]!! elapsed: 0.000100<br />connected [2]!! elapsed: 0.000563<br />connected [4]!! elapsed: 0.001228<br />connected [3]!! elapsed: 0.001229<br />connected [7]!! elapsed: 0.001703<br />connected [5]!! elapsed: 0.000936<br />connected [9]!! elapsed: 0.001097<br />connected [6]!! elapsed: 0.000660<br />connected [8]!! elapsed: 0.001013<br />connected [10]!! elapsed: 0.001433<br />----------- total test elapsed: 0.014272&nbsp; ---&gt; !!!!<br /><br />**** tcpdump 보면 이상내역 없다.. 정상적으로 연결 이후 전송 후 종료..... ---&gt; 리눅스에서는 backlog 설정에 따른 비정상 동작이 없다??????/<br />﻿jeremyko@jeremyko-VirtualBox:~/mydev/socket_test/socket_multithread_exemple$ sudo tcpdump -ilo port 1101<br />tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br />listening on lo, link-type EN10MB (Ethernet), capture size 65535 bytes<br />//!!! SYN - SYN/ACK - ACK<br />00:23:09.779416 IP localhost.57593 &gt; localhost.1101: Flags [S], seq 1643394902, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779434 IP localhost.1101 &gt; localhost.57593: Flags [S.], seq 2130341858, ack 1643394903, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779455 IP localhost.57593 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br /><br />00:23:09.779651 IP localhost.57594 &gt; localhost.1101: Flags [S], seq 2969512824, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779663 IP localhost.1101 &gt; localhost.57594: Flags [S.], seq 1098891634, ack 2969512825, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779699 IP localhost.57594 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br /><br />00:23:09.779742 IP localhost.57595 &gt; localhost.1101: Flags [S], seq 1200843580, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779752 IP localhost.1101 &gt; localhost.57595: Flags [S.], seq 511003082, ack 1200843581, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779767 IP localhost.57595 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br /><br />00:23:09.779835 IP localhost.57594 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.779839 IP localhost.57596 &gt; localhost.1101: Flags [S], seq 2613165261, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779845 IP localhost.1101 &gt; localhost.57594: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779853 IP localhost.1101 &gt; localhost.57596: Flags [S.], seq 3186477819, ack 2613165262, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779869 IP localhost.57596 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779870 IP localhost.57597 &gt; localhost.1101: Flags [S], seq 2118845851, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779876 IP localhost.57598 &gt; localhost.1101: Flags [S], seq 928157706, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779887 IP localhost.1101 &gt; localhost.57597: Flags [S.], seq 1838437840, ack 2118845852, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779898 IP localhost.57599 &gt; localhost.1101: Flags [S], seq 2955548588, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.779898 IP localhost.1101 &gt; localhost.57598: Flags [S.], seq 3815382666, ack 928157707, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779904 IP localhost.57597 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779909 IP localhost.57596 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.779909 IP localhost.1101 &gt; localhost.57599: Flags [S.], seq 388215384, ack 2955548589, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.779916 IP localhost.57598 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779918 IP localhost.1101 &gt; localhost.57596: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779925 IP localhost.57599 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779944 IP localhost.57597 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.779953 IP localhost.1101 &gt; localhost.57597: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779979 IP localhost.57598 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.779981 IP localhost.57599 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.779990 IP localhost.1101 &gt; localhost.57599: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.779990 IP localhost.1101 &gt; localhost.57598: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780036 IP localhost.57595 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780044 IP localhost.1101 &gt; localhost.57595: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780094 IP localhost.57593 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780119 IP localhost.1101 &gt; localhost.57593: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780133 IP localhost.1101 &gt; localhost.57593: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780149 IP localhost.57593 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780165 IP localhost.57593 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780189 IP localhost.1101 &gt; localhost.57593: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780199 IP localhost.57593 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780204 IP localhost.57600 &gt; localhost.1101: Flags [S], seq 2159181697, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.780215 IP localhost.1101 &gt; localhost.57600: Flags [S.], seq 1212294612, ack 2159181698, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.780229 IP localhost.57600 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780324 IP localhost.57601 &gt; localhost.1101: Flags [S], seq 2537717249, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.780335 IP localhost.1101 &gt; localhost.57601: Flags [S.], seq 4286027042, ack 2537717250, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 1600474,nop,wscale 7], length 0<br />00:23:09.780349 IP localhost.57601 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780360 IP localhost.57602 &gt; localhost.1101: Flags [S], seq 420825285, win 43690, options [mss 65495,sackOK,TS val 1600474 ecr 0,nop,wscale 7], length 0<br />00:23:09.780398 IP localhost.57600 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780455 IP localhost.57601 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780758 IP localhost.1101 &gt; localhost.57594: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 694<br />00:23:09.780778 IP localhost.57594 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780791 IP localhost.57594 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780849 IP localhost.1101 &gt; localhost.57594: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.780859 IP localhost.57594 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600474 ecr 1600474], length 0<br />00:23:09.787889 IP localhost.1101 &gt; localhost.57595: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600476 ecr 1600474], length 694<br />00:23:09.787923 IP localhost.57595 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600476 ecr 1600476], length 0<br />00:23:09.787944 IP localhost.57595 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600476 ecr 1600476], length 0<br />00:23:09.787966 IP localhost.1101 &gt; localhost.57595: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600476 ecr 1600476], length 0<br />00:23:09.787976 IP localhost.57595 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600476 ecr 1600476], length 0<br />00:23:09.789241 IP localhost.1101 &gt; localhost.57596: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600476 ecr 1600474], length 694<br />00:23:09.789370 IP localhost.57596 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600476], length 0<br />00:23:09.789392 IP localhost.57596 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600476], length 0<br />00:23:09.789415 IP localhost.1101 &gt; localhost.57596: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.789424 IP localhost.57596 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.790662 IP localhost.1101 &gt; localhost.57597: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600474], length 694<br />00:23:09.790711 IP localhost.57597 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.790728 IP localhost.57597 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.790778 IP localhost.1101 &gt; localhost.57597: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.790789 IP localhost.57597 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.791923 IP localhost.1101 &gt; localhost.57598: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600474], length 694<br />00:23:09.791950 IP localhost.57598 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.791966 IP localhost.57598 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.792010 IP localhost.1101 &gt; localhost.57598: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.792020 IP localhost.57598 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600477 ecr 1600477], length 0<br />00:23:09.793235 IP localhost.1101 &gt; localhost.57599: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600477 ecr 1600474], length 694<br />00:23:09.793428 IP localhost.57599 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600478 ecr 1600477], length 0<br />00:23:09.793453 IP localhost.57599 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600478 ecr 1600477], length 0<br />00:23:09.793579 IP localhost.1101 &gt; localhost.57599: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600478 ecr 1600478], length 0<br />00:23:09.793594 IP localhost.57599 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600478 ecr 1600478], length 0<br />00:23:09.981417 IP localhost.57600 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600525 ecr 1600474], length 694<br />00:23:09.981429 IP localhost.57601 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600525 ecr 1600474], length 694<br />00:23:09.981491 IP localhost.1101 &gt; localhost.57600: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.981572 IP localhost.1101 &gt; localhost.57601: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.981947 IP localhost.1101 &gt; localhost.57600: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 694<br />00:23:09.981988 IP localhost.57600 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.982015 IP localhost.57600 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.982133 IP localhost.1101 &gt; localhost.57600: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.982149 IP localhost.57600 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.984151 IP localhost.1101 &gt; localhost.57601: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 694<br />00:23:09.984208 IP localhost.57601 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.984249 IP localhost.57601 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.984392 IP localhost.1101 &gt; localhost.57601: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:09.984418 IP localhost.57601 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600525 ecr 1600525], length 0<br />00:23:10.777409 IP localhost.57602 &gt; localhost.1101: Flags [S], seq 420825285, win 43690, options [mss 65495,sackOK,TS val 1600724 ecr 0,nop,wscale 7], length 0<br />00:23:10.777457 IP localhost.1101 &gt; localhost.57602: Flags [S.], seq 3416412213, ack 420825286, win 43690, options [mss 65495,sackOK,TS val 1600724 ecr 1600724,nop,wscale 7], length 0<br />00:23:10.777491 IP localhost.57602 &gt; localhost.1101: Flags [.], ack 1, win 342, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br />00:23:10.777661 IP localhost.57602 &gt; localhost.1101: Flags [P.], seq 1:695, ack 1, win 342, options [nop,nop,TS val 1600724 ecr 1600724], length 694<br />00:23:10.777679 IP localhost.1101 &gt; localhost.57602: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br />00:23:10.777966 IP localhost.1101 &gt; localhost.57602: Flags [P.], seq 1:695, ack 695, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 694<br />00:23:10.778005 IP localhost.57602 &gt; localhost.1101: Flags [.], ack 695, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br />00:23:10.778030 IP localhost.57602 &gt; localhost.1101: Flags [F.], seq 695, ack 695, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br />00:23:10.778164 IP localhost.1101 &gt; localhost.57602: Flags [F.], seq 695, ack 696, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br />00:23:10.778178 IP localhost.57602 &gt; localhost.1101: Flags [.], ack 696, win 353, options [nop,nop,TS val 1600724 ecr 1600724], length 0<br /><br /><br /><br />//////////////////////// HP-UX ---&gt; os x 와 동일한가??? ---&gt; check!!<br />backlog defines the desirable queue length for pending connections.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The actual queue length may be greater than the specified backlog.&nbsp; If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a connection request arrives when the queue is full, the client will<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; receive an ETIMEDOUT error.<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; backlog is limited to the range of 0 to SOMAXCONN, which is defined in<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;sys/socket.h&gt;.&nbsp; SOMAXCONN is currently set to 4096.&nbsp; If any other<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value is specified, the system automatically assigns the closest value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; within the range.&nbsp; A backlog of 0 specifies only 1 pending connection<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is allowed at any given time.