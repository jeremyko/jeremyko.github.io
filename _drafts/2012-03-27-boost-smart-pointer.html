---
layout: post
title: boost - smart pointer
date: '2012-03-27T17:44:00.001+09:00'
author: jeremyko
tags:
- cpp
- boost
modified_time: '2016-12-31T15:20:36.742+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-7642290614484669068
blogger_orig_url: https://jeremyko.blogspot.com/2012/03/boost-smart-pointer.html
---

<span style="background-color: white; color: #555555; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: 12px; line-height: 18px; text-align: left;">Copyright © 2008-2010 Boris Schäling</span><br /><div style="background-color: white; color: #333333; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">이글은 다음 사이트 내용을 참조로 작성되었고. 개인적인 Study 목적으로 작성되었습니다.</span></div><div style="background-color: white; color: #333333; font-family: Arial, Tahoma, Helvetica, FreeSans, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">The contents of this page are constructed with reference to the following site and&nbsp;</span><span style="background-color: white; color: #999999; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">translated just for personal academic study only</span><span style="background-color: white; color: #999999; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">. &nbsp;</span><b style="font-family: arial, helvetica, sans-serif;"><a href="http://en.highscore.de/cpp/boost/" style="color: #7d181e; text-decoration: none;" target="_blank"><span style="background-color: white; color: #999999; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">http://en.highscore.de/cpp/boost/</span></a></b></div><br /><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>boost::scoped_ptr</b></span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">std::auto_ptr과 달리 소유권 이전이 불가하다. 일반 포인터처럼 사용가능.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">한번 생성된 포인터에 다른 객체 할당시, 이전 객체는 자동적으로 파괴된다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">소멸자에서 delete를 호출하기 때문에 동적으로 할당된 배열을 담을수 없다 (이경우는 다음의 boost::scoped_array를 사용).</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">오버로드된 연산자 : operator*(), operator-&gt;(), operator bool().</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">추가된 함수 : get(), reset()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/scoped_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::scoped_ptr&lt;int&gt; i(new int);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; *i = 1;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; *i.get() = 2;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; i.reset(new int);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>boost::scoped_array</b></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">위scoped_ptr와 동일하고 차이점은 소멸자에서 delete[]가 호출된다 (때문에 당연히 동적 배열에만 사용되어야함).</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/scoped_array.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::scoped_array&lt;int&gt; i(new int[2]);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; *i.get() = 1;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; i[1] = 2;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; i.reset(new int[3]);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">boost::shared_ptr</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">boost::scoped_ptr 와 근본적으로 같지만 가장큰 차이점은 shared_ptr들간에 소유권을 공유할수있다.(그리고 참조횟수가 관리된다.) 덕분에 copy가 가능. STL 컨테이너에서 유용하게 사용가능함.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/shared_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;vector&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; std::vector&lt;boost::shared_ptr&lt;int&gt; &gt; v;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(boost::shared_ptr&lt;int&gt;(new int(1))); //auto_ptr 불가</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(boost::shared_ptr&lt;int&gt;(new int(2)));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">shared_ptr 생성자에서 2번째 인자로, 소멸자 호출시에 불려질 함수 혹은 함수자를 전달가능.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/shared_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;windows.h&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::shared_ptr&lt;void&gt; h(OpenProcess(PROCESS_SET_INFORMATION,</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FALSE, GetCurrentProcessId()),</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CloseHandle);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; SetPriorityClass(h.get(), HIGH_PRIORITY_CLASS);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>boost::share_array</b></span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">shared_ptr과 차이점은 소멸자에서 delete[]를 호출한다는것.(즉. 동적 할당 배열만 사용가능)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>boost::weak_ptr</b></span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">weak_ptr 는 share_ptr 로 초기화 되어야 한다는 제약 (즉 이것은 share_ptr와 관련되어서만 사용해야함.)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">lock() 메소드를 제공 =&gt; 자신을 초기화 시켰던 shared_ptr를 돌려준다 (호출되는 시점에 shared_ptr 가 존재하는 경우) 만약 shared_ptr 내 객체가 없다면 0을 리턴.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">weak_ptr은 객체의 생명주기에 영향을 주지 않는다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">아래 예제에서는 &nbsp;함수내에서 shared_ptr을 이용해서 객체가 사용될때 print를 수행하기 위한 확인을 weak_ptr로 하고 있다 (간단히 말하자면 shared_ptr 확인 용도).</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;windows.h&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/shared_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/weak_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;iostream&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">DWORD WINAPI reset(LPVOID p)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::shared_ptr&lt;int&gt; *sh = static_cast&lt;boost::shared_ptr&lt;int&gt;*&gt;(p);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; sh-&gt;reset();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; return 0;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">DWORD WINAPI print(LPVOID p)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::weak_ptr&lt;int&gt; *w = static_cast&lt;boost::weak_ptr&lt;int&gt;*&gt;(p);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::shared_ptr&lt;int&gt; sh = w-&gt;lock();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; if (sh)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; std::cout &lt;&lt; *sh &lt;&lt; std::endl;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; return 0;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::shared_ptr&lt;int&gt; sh(new int(99));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::weak_ptr&lt;int&gt; w(sh);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; HANDLE threads[2];</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; threads[0] = CreateThread(0, 0, reset, &amp;sh, 0, 0);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; threads[1] = CreateThread(0, 0, print, &amp;w, 0, 0);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; WaitForMultipleObjects(2, threads, TRUE, INFINITE);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>intrusive_ptr</b></span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">shared_ptr과 근본적으로 같다. 차이점은 shared_ptr경우 참조횟수를 내부적으로 관리하지만</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">이것은 개발자가 참조횟수 관리를 스스로 해야한다는 것이다.&nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">기존에 이미 자체적으로 참조횟수관리를 수행중인 객체에서 사용가능하다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">다음 예제에서는 com 객체의 참조횟수 관리에 사용.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/intrusive_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;atlbase.h&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;iostream&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">void intrusive_ptr_add_ref(IDispatch *p) //자동으로 호출된다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; p-&gt;AddRef();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">void intrusive_ptr_release(IDispatch *p) //자동으로 호출된다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; p-&gt;Release();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">void check_windows_folder()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CLSID clsid;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CLSIDFromProgID(CComBSTR("Scripting.FileSystemObject"), &amp;clsid);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; void *p;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CoCreateInstance(clsid, 0, CLSCTX_INPROC_SERVER, __uuidof(IDispatch), &amp;p);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::intrusive_ptr&lt;IDispatch&gt; disp(static_cast&lt;IDispatch*&gt;(p));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CComDispatchDriver dd(disp.get());</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CComVariant arg("C:\\Windows"); //디렉토리 존재 여부 체크.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CComVariant ret(false);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; dd.Invoke1(CComBSTR("FolderExists"), &amp;arg, &amp;ret);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; std::cout &lt;&lt; (ret.boolVal != 0) &lt;&lt; std::endl;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">void main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CoInitialize(0);</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; check_windows_folder();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; CoUninitialize();</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: x-small;"><b>ptr_container</b></span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">동적 할당된 객체를 컨테이너에 저장할때, 위에 설명된 스마트 포인터를 활용할수도 있지만,&nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">만약 객체의 소유권이 공유될 필요가 없거나 스마트 포인터 사용으로 인한 오버헤드가 싫다면,</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">보다 효율적으로 동적 할당 객체를 관리하기 위한 특별한 컨테이너들을 사용할수 있다. &nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/ptr_container.html&nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">일반 컨테이너에 포인터를 저장하는것과 비교시, 보다 사용하기 쉽고(코딩량 감소),</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">메모리 오버헤드가 없고, 일반적으로 빠르다</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">예를 들어 다음 코드는 &nbsp;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/shared_ptr.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;vector&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; std::vector&lt;boost::shared_ptr&lt;int&gt; &gt; v;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(boost::shared_ptr&lt;int&gt;(new int(1)));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(boost::shared_ptr&lt;int&gt;(new int(2)));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">아래처럼 쓸수 있다.</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">#include &lt;boost/ptr_container/ptr_vector.hpp&gt;</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">int main()</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">{</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; boost::ptr_vector&lt;int&gt; v; &nbsp;//많이 줄었군...</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(new int(1));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">&nbsp; &nbsp; v.push_back(new int(2));</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">}</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><br /></span><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">컨테이너내 모든 객체에 대한 소유권을 갖는다.(컨테이너 소멸시 객체도 소멸됨)</span><br /><span style="font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;">그밖에 컨테이너들.</span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_deque</b></span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_list</b></span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_set</b></span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_map</b></span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_unordered_set</b></span><br /><span style="color: #134f5c; font-family: &quot;arial&quot; , &quot;helvetica&quot; , sans-serif; font-size: xx-small;"><b>boost::ptr_unordered_map</b></span>