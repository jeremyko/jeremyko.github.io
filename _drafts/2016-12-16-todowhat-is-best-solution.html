---
layout: post
title: TODO_what is the best solution?
date: '2016-12-16T00:05:00.000+09:00'
author: jeremyko
tags:
modified_time: '2016-12-16T00:05:06.587+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-2646672655853333749
blogger_orig_url: https://jeremyko.blogspot.com/2016/12/todowhat-is-best-solution.html
---

/*<br />///////////////////////////////////////////////////////////////////////////////<br />&nbsp;------------------------------------------------------------------------------<br />&nbsp;20141023 kojh : partial url 처리 수정<br />&nbsp;------------------------------------------------------------------------------<br />&nbsp;- PGW로 부터 입력되는 url의 최대값은 data_format을 통해 이미 고정된(59길이) 값이다.<br />&nbsp;- DB에 저장된 url의 크기는 최대 200 까지 가능.<br />&nbsp;- DB에 있는 url은 기본 주소 정보를 나타낸다.<br />&nbsp;&nbsp; PGW로 부터 들어오는 url은 DB에 있는 기본 url + 이후 추가 url정보 가능하다. <br />&nbsp;&nbsp; length(url in PGW CDR) &gt; length(url in DB) <br /><br />&lt; Map 생성 &gt;<br /><br />1. DB 에 있는 전체 url 길이를 파악, 크게 4개의 구간으로 구분한다. <br />&nbsp;&nbsp; 최소 url길이(min)는 0은 제외한다.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; min&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; !---|-----|-----|----------|-------------------|<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 구간1 구간2&nbsp;&nbsp;&nbsp; 구간3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 구간4<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp; 예)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; min(길이0제외)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |---|-----|-----|----------|-------------------|<br />&nbsp;&nbsp; url길이: 0&nbsp; 10&nbsp;&nbsp;&nbsp; 33&nbsp;&nbsp;&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 105&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 200 <br />&nbsp;&nbsp;&nbsp; <br />2. DB url 길이를 보고 어떤 구간에 해당되는지 판단<br />&nbsp;&nbsp; 예를 들어 db url 길이가 35라면, 구간2 에 해당된다.<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; min&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; !---|-----|-----|----------|-------------------|<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 구간1 구간2&nbsp;&nbsp;&nbsp; 구간3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 구간4<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |-----------| (db url length = 35)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 구간2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |--------------------| (db url length = 70) : 구간3<br />&nbsp;&nbsp;&nbsp; <br />3. url관리는 multimap으로 관리된다.<br />&nbsp;&nbsp; map의 key는 해당되는 구간 시작값만큼 자른 url이다.<br />&nbsp;&nbsp; 때문에 동일한 partial url 을 key로 여러개의 데이터가 존재가능하다.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; min&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; max <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; !---|-----|-----|----------|--------------------|<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |---|nLenOfUrlKeyRange1 (10)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |---------|nLenOfUrlKeyRange2 (33)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |---------------|nLenOfUrlKeyRange3 (57)&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |--------------------------|nLenOfUrlKeyRange4 (105)&nbsp;&nbsp; <br /><br />&nbsp;&nbsp; 예를 들어 db url 길이가 35라면(구간2), 33 길이 만큼만(nLenOfUrlKeyRange2) key로 사용한다.<br />&nbsp;&nbsp; <br />&nbsp;&nbsp; 한편, map의 value에는 full db url 를 찾을수 있다.&nbsp;&nbsp;&nbsp; <br /><br /><br />&lt; Map 탐색 &gt;<br /><br />1. 수신된 PGW url 을 이용,검색key를 생성하고, multimap에서 동일한 key를 가진 목록을 얻는다. <br />&nbsp;&nbsp; 구간 4 --&gt; 구간1의 순서로 검색key를 생성한다.<br />&nbsp;&nbsp; 검색 key생성은 수신된 url을 각 구간 시작값만큼 자르는것을 의미한다.<br />&nbsp;&nbsp; <br />2. 이렇게 만든 key로 multimap에서 equal_range로 목록을 구한다.<br /><br />3. 구해진 목록을 순회하면서, 수신된 url에 <br />&nbsp;&nbsp; db url(기본url)이 포함되있는지 여부를 판단하고, 그렇다면, 최종 SVC_TYPE을 구한다. <br />&nbsp;------------------------------------------------------------------------------<br /><br /><br />///////////////////////////////////////////////////////////////////////////////<br />*/