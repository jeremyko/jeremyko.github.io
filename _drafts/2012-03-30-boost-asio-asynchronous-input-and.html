---
layout: post
title: boost - asio, Asynchronous Input and Output
date: '2012-03-30T10:48:00.002+09:00'
author: jeremyko
tags:
- cpp
- boost
- asio
modified_time: '2016-12-31T15:20:36.734+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-5932830362572761575
blogger_orig_url: https://jeremyko.blogspot.com/2012/03/boost-asio-asynchronous-input-and.html
---

<span style="background-color: white; color: #555555; font-family: Arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;">Copyright © 2008-2010 Boris Schäling</span><br /><div style="font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: Arial, helvetica, sans-serif;">이글은 다음 사이트 내용을 참조로 작성되었고. 개인적인 Study 목적으로 작성되었습니다.</span></div><div style="font-size: 12px; line-height: 18px; text-align: left;"><span style="background-color: white; color: #999999; font-family: Arial, helvetica, sans-serif;">The contents of this page are constructed with reference to the following site and&nbsp;</span><span style="background-color: white; color: #999999; font-family: Arial, helvetica, sans-serif;">translated just for personal academic study only</span><span style="background-color: white; color: #999999; font-family: Arial, helvetica, sans-serif;">. &nbsp;</span><b style="font-family: arial, helvetica, sans-serif;"><a href="http://en.highscore.de/cpp/boost/" style="text-decoration: none;" target="_blank"><span style="background-color: white; color: #999999; font-family: Arial, helvetica, sans-serif;">http://en.highscore.de/cpp/boost/</span></a></b></div><br /><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><div style="background-color: #e4e4e4;"><div style="color: #006699;"></div><span style="font-family: arial, helvetica, sans-serif;"></span></div></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="color: #006699; font-family: Arial, helvetica, sans-serif; font-size: small;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="color: #006699; font-family: Arial, Helvetica, sans-serif; font-size: small;">boost::asio</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="color: #006699; font-family: Arial, Helvetica, sans-serif;"><b>I/O Services and I/O Objects</b></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">비동기적인 데이터처리는 I/O services 와 I/O objects를 기반으로 이루어진다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">I/O services는 비동기처리를 가능하게 해주는 운영체계 인터페이스를 추상화하고,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">I/O objects는 특정 비동기 동작을 시작하기 위해 사용된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">boost::io_service 클래스가 I/O services를 위한 클래스이며,각 운영체계에 최적화되어 구현되어 있다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><br /><a name='more'></a><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">Boost.Asio에는 각각의 I/O Object를 위한 몇몇 클래스들이 존재한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">이 중에서 boost::asio::ip::tcp::socket 는 네트워크 송수신, boost::asio::deadline_timer 는&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">타이머기능을 수행한다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::io_service io_service;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer(io_service, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>timer.async_wait(handler);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>io_service.run();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">먼저 io_service 가 정의되고, I/O object인 timer를 초기화 시킬때 사용된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">예제의 boost::asio::deadline_timer과 마찬가지로 모든 I/O objects는 첫번째 인자로&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">I/O service를 요구한다. async_wait() 인자로 비동기처리를 위한 함수를 전달한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">입력인자로 주어진 함수는 즉시 호출되지 않고, 5초가 지난 다음 호출될것이다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">async_wait()의 장점은, 이함수는 블럭되지 않고 즉시 리턴된다는 것이다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">사용자는 이함수 이후에 계속 작업을 수행할수 있다. 이러한 함수를 non-blocking이라고 표시한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">한편, I/O object는 blocking 함수도 제공한다. 특정 동작이 수행되기까지 블럭되어야만 하는&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">실행흐름이 있는 경우 사용된다. 위 예제에서 async_wait() 대신 blocking함수인 wait()을 사용할수도 있다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::asio::io_service io_service;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer(io_service, boost::posix_time::seconds(10));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>timer.wait(); //5초동안 blocking된다.</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">비동기 작업을 시작한 경우에는 run() 함수를 반드시 호출해야 하는데,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">이는 5초 경과후 handler()를 호출하기 위해, 운영체계에 의한 제어의 이전이 필요하기 때문이다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">async_wait() 이 즉시 리턴되는것과 달리, run()은 블럭킹된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">비동기 처리시에 block되는 함수를 호출해야만 한다는것이 이상하게 느껴질수 있지만,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">이것은 꼭 필요하다. 만약 run()호츨에서 블럭되지 않는다면 프로그램이 종료된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">특정 I/O service의 모든 비동기 작업이 완료된 경우에 제어권이 run()로 넘어오게 되고,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">이때 run()함수가 리턴된다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">만약 어플리케이션이 블럭되지 앟게 하려면, run()함수를 새로운 쓰레드 내부에서 호출해야한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">run()함수는 호출된 쓰레드만을 블럭시키기 때문이다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="color: #006699; font-family: Arial, Helvetica, sans-serif;"><b>Scalability and Multithreading</b></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">asio와 스레드를 결합해서 scalability을 더욱 증가시킨다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">boost::asio::io_service 객체에 대해서 run()을 호출하면, 연관된 핸들러함수가&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">같은 쓰레드 내에서 실행된다. 이때 멀티쓰레드를 사용하면 어플리케이션은 run()을</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">여러번 호출할수 있다. 이경우 비동기 작업이 완료되면, 해당 I/O Service는 핸들러 함수를&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">여러 쓰레드중 하나에서 실행한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">먼저 다음 예제를 보면,</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler1(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler2(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; "10 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::io_service io_service;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer1(io_service, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>timer1.async_wait(handler1);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer2(io_service, boost::posix_time::seconds(10));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>timer2.async_wait(handler2);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>io_service.run(); //handler1, handler2 will be invoked by this(main) thread</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">프로그램 결과는 다음과 같다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">5 s.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">10 s.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">함수 handler1, handler2는 모두 run()을 호출한, 하나의 쓰레드(main)내에서 호출 된다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">이것의 의미는 하나의 쓰레드가 핸들러 함수를 순차적으로 처리한다는 것이다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">이 예제를 쓰레드와 결합한 다음 예제를 보면,</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/thread.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler1(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler2(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::io_service io_service;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void run()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>io_service.run();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer1(io_service, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>timer1.async_wait(handler1);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>boost::asio::deadline_timer timer2(io_service, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>timer2.async_wait(handler2);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::thread thread1(run);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::thread thread2(run);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>thread1.join();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>thread2.join();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span><span style="font-family: Arial, Helvetica, sans-serif;">프로그램 결과는 다음과 같다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">5 s.5 s.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">이제, run()는 별개의 스레드에서 실행이 되고있다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">하나의 쓰레드가 하나의 핸들러 함수를 실행하게 되고, handler1, handler2함수는&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">동시에 수행된다. 그결과, 출력되는 문자열은 더이상 순차적으로 표기되지 않는다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">출력문자열이 섞이는 위예제는 std::cout 가 동기화되지 않았기 때문인데,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">각 핸들러가 패러럴하게 독자적으로 수행될수 없는 이 상황에서는 멀티쓰레드로&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">인한 잇점은 별로 없을 것이다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">하나의 I/O Service에 대해서 여러번 run()을 호출하는 것은 Boost.Asio기반 어플리케이션에&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">확장성을 부여하기 위해 권장되는 방법이다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">그런데, 다른 방법도 존재한다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">하나의 I/O Service에 여러개의 스레드를 바인딩하는 대신, 여러개의 I/O Service가&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">생성될수 있다. 각 I/O Service는 하나의 쓰레드를 사용하게 된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">만약 I/O Service 이 갯수가 시스템의 전체 CPU 코어와 일치하면, 비동기 작업은&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">그들의 고유한 코어에서 수행 가능하다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/thread.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler1(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void handler2(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>std::cout &lt;&lt; "5 s." &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::io_service io_service1;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::io_service io_service2;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void run1()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>io_service1.run();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void run2()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>io_service2.run();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer1(io_service1, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>timer1.async_wait(handler1);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::deadline_timer timer2(io_service2, boost::posix_time::seconds(5));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>timer2.async_wait(handler2);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::thread thread1(run1);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::thread thread2(run2);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>thread1.join();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>thread2.join();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">주의점: multiple I/O services 은 하드웨어, 운영체계, 컴파일러, 잠재적인 병목현상등을&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">고려해서 명백한 잇점이 있는 경우만 사용되어야 한다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="color: #006699; font-family: Arial, Helvetica, sans-serif;"><b>Network Programming</b></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">Boost.Asio가 어떠한 데이터도 비동기적으로 처리할수 있지만 주로 네트워크 프로그래밍에 사용되어진다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">네트워크 함수는, 네트워간의 전송이 즉각적이지 않고, 그 처리결과를 즉시 확인할수 없다는 점에서&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">비동기 처리의 완벽한 예라고 할수있다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">네트워크 프로그래밍을 위한 boost::asio::ip::tcp::socket 가 존재한다.</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;">// 'Highscore' 홈페이지 내용을 받아오는 예제</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/array.hpp&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;iostream&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;string&gt;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::io_service io_service;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::ip::tcp::resolver resolver(io_service);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::ip::tcp::socket sock(io_service);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::array&lt;char, 4096&gt; buffer;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void read_handler(const boost::system::error_code &amp;ec, std::size_t bytes_transferred)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>if (!ec)</span><span class="Apple-tab-span" style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small; white-space: pre;"> </span><span style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">    </span>std::cout &lt;&lt; std::string(buffer.data(), bytes_transferred) &lt;&lt; std::endl;</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>sock.async_read_some(boost::asio::buffer(buffer), read_handler);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void connect_handler(const boost::system::error_code &amp;ec)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>if (!ec)&nbsp;</span><span style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; <span style="white-space: pre;">&nbsp;   </span>boost::asio::write(sock, boost::asio::buffer("GET / HTTP 1.1\r\nHost: highscore.de\r\n\r\n"));</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">    </span>sock.async_read_some(boost::asio::buffer(buffer), read_handler);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void resolve_handler(const boost::system::error_code &amp;ec, boost::asio::ip::tcp::resolver::iterator it)</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>if (!ec)</span><span class="Apple-tab-span" style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small; white-space: pre;"> </span><span style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; <span style="white-space: pre;">&nbsp;   </span>sock.async_connect(*it, connect_handler);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>boost::asio::ip::tcp::resolver::query query("www.highscore.de", "80");</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>resolver.async_resolve(query, resolve_handler);</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>io_service.run();</span></div><div style="background-color: white; line-height: 18px; text-align: left;"><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="background-color: white; color: #555555; line-height: 18px; text-align: left;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="background-color: white; line-height: 18px; text-align: left;"><div style="color: #555555;"></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">출력:</span><br /><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"></div><div style="color: #555555;"><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;"><span style="font-size: x-small;">HTTP/1.1 301 Moved Permanently</span></span></div><div style="color: #555555;"></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Date: Fri, 30 Mar 2012 01:51:17 GMT</span></div><div style="color: #555555;"></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Server: Apache/2.2.22 (Unix) DAV/2 PHP/5.2.17 mod_wsgi/2.6 Python/2.5.1</span></div><span style="color: #555555; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"></span><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Location: http://www.highscore.de/</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Content-Length: 351</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Connection: close</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Content-Type: text/html; charset=iso-8859-1</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;html&gt;&lt;head&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;title&gt;301 Moved Permanently&lt;/title&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;/head&gt;&lt;body&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;h1&gt;Moved Permanently&lt;/h1&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;p&gt;The document has moved &lt;a href="http://www.highscore.de/"&gt;here&lt;/a&gt;.&lt;/p&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;hr&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;address&gt;Apache/2.2.22 (Unix) DAV/2 PHP/5.2.17 mod_wsgi/2.6 Python/2.5.1 Server at highscore.de Port 80&lt;/address&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;/body&gt;&lt;/html&gt;</span></div><div style="color: #555555;"><br /></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">예제에서 3가지 핸들러를 사용하고 있다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">connect_handler()는 연결되는 경우, read_handler()는 데이터를 받아들이는 경우에&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">호출된다. resolve_handler()는 name resolution(문자열 주소가 IP address로 해석)이&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">완료될때 호출된다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">boost::asio::ip::tcp::resolver::query 객체에 DNS server로 전달될 주소를 지정하고&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">async_resolve() 함수를 통해서 이름 해석을 비동기로 요청한다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">이름 해석이 완료되면 resolve_handler() 가 호출되고, async_connect()를 호출되어</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">역시 비동기적으로 연결을 요청한다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">연결이 완료될때 비동기로 connect_handler() 가 호출되고, connect_handler() 내부에서는&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">write() 호출후 async_read_some()를 통해서 비동기 데이터 수신을 시작한다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">수신 데이터를 저장하기 위해서 첫번째 인자로 boost::asio::buffer 가 사용된다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">read_handler() 는 데이터가 수신될때마다 호출된다. 수신된 데이터 양은&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">std::size_t 타입의 bytes_transferred 인자로 알수있다. read_handler에서 다시 한번&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">async_read_some()을 호출했는데, 아직 받아야할 데이터가 남아있을수 있기 때문이다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">서버외의 연결이 종료되면 핸들러로 에러가 전달된다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">위 예제에서는 연결이 종료되는 경우(즉, 예제처럼 웹서버인 경우는 데이터 전송이 완료된 경우)&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">핸들러 내부에서 에러를 받게 되고, 더이상 async_read_some()호출을 안하기 때문에&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">run()에서 대기할것이 없어지고, 프로그램은 종료된다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">각 핸들러 함수에서는 전달되는 error_code를 검사해서 정상처리 여부를 확인한다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">위 예제는 홈페이지 데이터를 가져오는 경우였다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">다음 예제는 간단한 웹서버이다. 다른곳으로 연결 시도 없이, 들어오는 연결을 기다린다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;boost/asio.hpp&gt;</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">#include &lt;string&gt;</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::io_service io_service;</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::ip::tcp::endpoint endpoint(boost::asio::ip::tcp::v4(), 80);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::ip::tcp::acceptor acceptor(io_service, endpoint);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">boost::asio::ip::tcp::socket sock(io_service);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">std::string data = "HTTP/1.1 200 OK\r\nContent-Length: 13\r\n\r\nHello, world!";</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void write_handler(const boost::system::error_code &amp;ec, std::size_t bytes_transferred)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void accept_handler(const boost::system::error_code &amp;ec)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;<span class="Apple-tab-span" style="white-space: pre;">   </span>if (!ec)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; <span style="white-space: pre;">&nbsp;   </span>boost::asio::async_write(sock, boost::asio::buffer(data), write_handler);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">int main()</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>acceptor.listen();</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>acceptor.async_accept(sock, accept_handler);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>io_service.run();</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">acceptor 는 I/O object 이다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">acceptor 초기화는 boost::asio::ip::tcp::endpoint 타입 객체를 통해서 이루어진다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">초기화가 완료된후 listen() 함수를 통해서 acceptor를 receive mode로 만든다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">그리고 async_accept() 함수를 통해서 연결을 기다린다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">연결이 들어오는 경우 accept_handler() 가 호출되고 그 내부에서는 boost::asio::async_write()&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">를 호출해서 비동기로 데이터를 보낸다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">전송을 위한 다른 비동기 함수로 boost::asio::ip::tcp::socket클래스의&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">async_write_some() 메서드가 있다. 이 함수는 1바이트라도 데이터가 전송된 경우,&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">매번 핸들러 함수를 호출한다. 모든 데이터 전송을 위해서는 전송안된 데이터의 양을&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">계산해서 모두 전송될때까지 반복적으로 async_write_some()을 호출해야 한다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">boost::asio::async_write()을 사용하면 이런 수고를 덜수 있다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">이함수는 모든 데이터가 전송 완료된 후 핸들러 함수를 호출해주기 때문이다.&nbsp;</span><span style="background-color: white; font-family: Arial, Helvetica, sans-serif;">위 예제에서 write_handler()는 모든 데이터가 전송된 시점에 호출될것이다.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">* 그럼 다시, 'Highscore' 홈페이지 내용을 받아오는 예제를 boost::asio::async_read()</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">를 사용해서 수정해 보자.</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void read_handler(const boost::system::error_code &amp;ec, std::size_t bytes_transferred)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; std::cout &lt;&lt; "****read_handler called :" &lt;&lt; ec.message() &lt;&lt; std::endl;</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; std::cout &lt;&lt; std::string(buffer.data(), bytes_transferred) &lt;&lt; std::endl;</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">void connect_handler(const boost::system::error_code &amp;ec)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>if (!ec)</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>{</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; <span style="white-space: pre;">&nbsp;   </span>boost::asio::write(sock, boost::asio::buffer("GET / HTTP 1.1\r\nHost: highscore.de\r\n\r\n"));</span></div><div><span style="background-color: white; color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; //sock.async_read_some(boost::asio::buffer(buffer), read_handler);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp; &nbsp; &nbsp; &nbsp; boost::asio::async_read(sock, boost::asio::buffer(buffer), read_handler);</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></div><div><span style="color: #660000; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">}</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">....</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">출력:</span></div><div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><span style="color: #073763; font-family: Arial, Helvetica, sans-serif; font-size: x-small;">****read_handler called :End of file</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">HTTP/1.1 301 Moved Permanently</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Date: Fri, 30 Mar 2012 01:56:12 GMT</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Server: Apache/2.2.22 (Unix) DAV/2 PHP/5.2.17 mod_wsgi/2.6 Python/2.5.1</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Location: http://www.highscore.de/</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Content-Length: 351</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Connection: close</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">Content-Type: text/html; charset=iso-8859-1</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;html&gt;&lt;head&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;title&gt;301 Moved Permanently&lt;/title&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;/head&gt;&lt;body&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;h1&gt;Moved Permanently&lt;/h1&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;p&gt;The document has moved &lt;a href="http://www.highscore.de/"&gt;here&lt;/a&gt;.&lt;/p&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;hr&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;address&gt;Apache/2.2.22 (Unix) DAV/2 PHP/5.2.17 mod_wsgi/2.6 Python/2.5.1 Server at highscore.de Port 80&lt;/address&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif; font-size: x-small;">&lt;/body&gt;&lt;/html&gt;</span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></div><div style="color: #555555;"><span style="font-family: Arial, Helvetica, sans-serif;">핸들러가 1번만 호출되는것을 확인할수 있다.</span></div><div style="color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px;"></div></div>