---
layout: post
title: Spring Remote (RMI) 예제
date: '2012-07-25T16:39:00.000+09:00'
author: jeremyko
tags:
- spring remote
- RMI
- spring
- java
modified_time: '2012-08-08T11:20:34.069+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-3178278464245613105
blogger_orig_url: https://jeremyko.blogspot.com/2012/07/spring-remote-rmi.html
---

<br />오늘 살펴볼 스프링 Remote 중에서 RMI 지원은 단순한 POJO 작성만으로도 RMI 서비스를 간편하게 발행할 수 있게 해준다. 간단한 예제를 작성해보자. 일단 프로그램은 java application 으로 하였다. RMI를 통한 통신이므로 서버 및 클라이언트 2개 프로젝트를 만들어야 한다. 먼저 서버를 만든다. <br /><br /><b style="background-color: #fff2cc;"><span style="color: #660000;">* 서버 작성 *</span></b><br /><br />소스코드는 다음을 참조한다.&nbsp;<a href="https://github.com/jeremyko/MySpringRMI" target="_blank"><b>https://github.com/jeremyko/MySpringRMI</b></a><br /><br /><div style="color: #660000;"><b>1. Eclipse 에서 신규 프로젝트를 생성한다.</b></div><br />File -&gt; New -&gt; java project -&gt; "MySpringRMI" 프로젝트 생성. 그리고 스프링 관련된 라이브러리들을 프로젝트 속성 -&gt; Java Build Path -&gt; Libraries 에 모두 추가한다.<br /><br /><div style="color: #660000;"><b>2. 스프링 설정파일을 다음과 같이 설정한다.</b></div><br /><span style="color: #6fa8dc;">// spring_conf.xml</span><br /><div style="color: black;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div style="color: black;">&lt;beans xmlns="http://www.springframework.org/schema/beans"</div><div style="color: black;">&nbsp;xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</div><div style="color: black;">&nbsp;xmlns:p="http://www.springframework.org/schema/p"</div><div style="color: black;">&nbsp;xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"&gt;</div><div style="color: black;"><br /></div><div style="color: black;">&nbsp; &lt;bean class="org.springframework.remoting.rmi.RmiServiceExporter"</div><div style="color: black;">&nbsp;&nbsp;&nbsp; p:service-ref="helloService"</div><div style="color: black;">&nbsp;&nbsp;&nbsp; p:serviceName="HelloService"</div><div style="color: black;">&nbsp;&nbsp;&nbsp; p:serviceInterface="kojh.spring.rmi.HelloService" /&gt;</div><div style="color: black;"><br /></div><div style="color: black;">&nbsp; &lt;bean id="helloService" class="kojh.spring.rmi.HelloServiceImpl"/&gt;</div><div style="color: black;">&lt;/beans&gt;</div><div style="color: black;"><br /></div><div style="color: black;">&lt;!-- p:registryPort="1107" --&gt;</div><br />service-ref 에는 서비스를 담당할 bean 즉, helloService로 설정한다. serviceName 속성을 통해서 RMI 서비스명을 HelloService 로 설정한다, 나중에 보게 되겠지만 이것을 참조해서 client가 이 서비스를 호출하게 된다. serviceInterface 는 해당 서비스가 구현하고 있는 인터페이스를 설정한다. 참고로, 기본적으로 RMI가 사용하는 포트는 1099 이다. 이값을 변경하기 위한 속성은 registryPort 이다.<br /><br /><div style="color: #660000;"><b>3. 서비스 인터페이스를 정의한다.</b></div><br /><div style="color: #6fa8dc;">// HelloService.java</div><div style="color: black;">package kojh.spring.rmi;</div><div style="color: black;"><br /></div><div style="color: black;">public interface HelloService</div><div style="color: black;">{</div><div style="color: black;">&nbsp;&nbsp;&nbsp; String sayHello(String name);</div><div style="color: black;">}</div><br /><a name='more'></a><br /><br /><div style="color: #660000;"><b>4. 이 인터페이스를 구현하는 클래스를 정의한다.</b></div><br />package kojh.spring.rmi;<br />public class HelloServiceImpl implements HelloService<br />{<br />&nbsp;&nbsp;&nbsp; public String sayHello(String name) <br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "Hello " + name;<br />&nbsp;&nbsp;&nbsp; }<br />}<br /><br /><div style="color: #660000;"><b>5. 마지막으로 RMI 서비스를 발행하기 위한 Main 이 필요하다.</b></div><br /><span style="color: #6fa8dc;">// DrivingMain.java</span> <br />package kojh.spring.test;<br />import org.springframework.context.ApplicationContext;<br />import org.springframework.context.support.ClassPathXmlApplicationContext;<br /><br />public class DrivingMain<br />{&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; public static void main(String[] args)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; ApplicationContext context = new ClassPathXmlApplicationContext("spring_conf.xml"); <br />&nbsp;&nbsp;&nbsp; }<br />}<br /><br />이것으로 RMI 서버가 완성 되었다. RMI 기능을 위한 코딩이라고 느낄만한 부분은 코드상에 어디에도 보이지 않는다는것이 Spring RMI사용의 장점이다. 모든 마법은 스프링 환경 설정 파일에서 이루어지고 있다.<br /><br /><div style="background-color: #fff2cc; color: #660000;"><b>* 클라이언트 작성*</b></div><br />소스코드는 다음을 참조한다. <b><a href="https://github.com/jeremyko/MySpringRMI_Client" target="_blank">https://github.com/jeremyko/MySpringRMI_Client</a></b><br /><div style="color: #660000;"><br /></div><div style="color: #660000;"><b>1. Eclipse 에서 신규 프로젝트를 생성한다.</b></div><br />File -&gt; New -&gt; java  project -&gt; "MySpringRMI_Client" 프로젝트 생성. 그리고 서버 작성시와 동일하게 스프링 관련된 라이브러리들을 프로젝트 속성 -&gt;  Java Build Path -&gt; Libraries 에 모두 추가한다.<br /><br /><div style="color: #660000;"><b>2. 스프링 설정파일을 다음과 같이 작성한다.</b></div><br />&nbsp;<span style="color: #6fa8dc;">// spring_conf.xml</span><br />&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;beans <br />&nbsp;&nbsp;&nbsp; xmlns="http://www.springframework.org/schema/beans"<br />&nbsp;&nbsp;&nbsp; xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />&nbsp;&nbsp;&nbsp; xmlns:context="http://www.springframework.org/schema/context"<br />&nbsp;&nbsp;&nbsp; xmlns:p="http://www.springframework.org/schema/p" <br />&nbsp;&nbsp;&nbsp; xsi:schemaLocation=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd"&gt;&nbsp;&nbsp;&nbsp; <br /><br />&nbsp; &lt;bean id="helloServiceOfClient" class="org.springframework.remoting.rmi.RmiProxyFactoryBean" <br />&nbsp;&nbsp;&nbsp; p:serviceUrl="rmi://localhost/HelloService" <br />&nbsp;&nbsp;&nbsp; p:serviceInterface="kojh.rmi.interfaces.HelloService" /&gt;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp; &lt;context:component-scan base-package="kojh.rmi.client"/&gt;<br />&lt;/beans&gt;<br /><br /><br />serviceUrl 속성은&nbsp; RMI 서비스 접근 URL 정보를 나타낸다. "rmi://" + 서버 ip + ":" + port 번호 + "/" + 서비스 명 (ex.rmi://localhost:1011/SomeService) 형식이다.<br /><br /><div style="color: #660000;"><b>3. 서버에서 사용된 서비스의 인터페이와 동일한 인터페이스가 필요하다.</b></div><br /><span style="color: #6fa8dc;">// HelloService.java </span><br />package kojh.rmi.interfaces;<br /><br />public interface HelloService<br />{<br />&nbsp;&nbsp;&nbsp; String sayHello(String name);<br />}<br /><br /><div style="color: #660000;"><b>4. 서비스를 호출하는 작업을 담당할클래스를 정의한다.</b></div><br /><span style="color: #6fa8dc;">// RmiClient.java </span><br />package kojh.rmi.client;<br /><br />import kojh.rmi.interfaces.HelloService;<br />import org.springframework.beans.factory.annotation.Autowired;<br />import org.springframework.stereotype.Component;<br /><br />@Component<br />public class RmiClient<br />{&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; <span style="color: #8e7cc3;">// static 이어야만 동작. </span><br /><span style="color: #8e7cc3;">&nbsp;&nbsp;&nbsp; //@Autowired: 흠..이상하게도 여기서 Autowired를 사용시에 와이어링이 되지 않는다</span><br />&nbsp;&nbsp;&nbsp; private static HelloService helloServiceOfClient;<br /><br />&nbsp;&nbsp;&nbsp; @Autowired <span style="color: #8e7cc3;">// 흠..여기서 Autowired 를 사용해서 Setter를 호출하게 해야 동작한다.</span><br />&nbsp;&nbsp;&nbsp; public void setHelloServiceOfClient(HelloService helloService)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; helloServiceOfClient = helloService;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; public void invokeRmi(String name)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("invoking RMI with name ["+ name +"]");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; String rslt = helloServiceOfClient.sayHello(name); <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.out.println("----&gt; Result: ["+ rslt +"]");<br />&nbsp;&nbsp;&nbsp; }<br />} <br /><br /><div style="color: #660000;"><b>5. 클라이언트의 동작을 확인하기 위한 Main 클래스를 작성한다.</b></div><br /><div style="color: #6fa8dc;">// RmiClientDrivingMain.java</div><br />package kojh.rmi.client;<br />import org.springframework.context.ApplicationContext;<br />import org.springframework.context.support.ClassPathXmlApplicationContext;<br /><br />public class RMIClientDrivingMain<br />{<br />&nbsp;&nbsp;&nbsp; public static void main(String[] args)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ApplicationContext context = new ClassPathXmlApplicationContext("spring_conf.xml");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RmiClient rmiClient = new RmiClient();&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rmiClient.invokeRmi("Tom");&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rmiClient.invokeRmi("Jane");<br />&nbsp;&nbsp;&nbsp; }<br />}<br /><br /><br />구동 결과는 다음과 같다.<br /><br /><div style="color: blue;">invoking RMI with name [Tom]<br />----&gt; Result: [Hello Tom]<br />invoking RMI with name [Jane]<br />----&gt; Result: [Hello Jane]</div><br /><br />