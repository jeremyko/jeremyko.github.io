---
layout: post
title: redis-benchmark 에서의 RPS(requests per second) 의미
date: '2020-04-30T11:47:00.003+09:00'
author: jeremyko
tags:
- redis-benchmark
- redis
modified_time: '2021-04-03T15:56:38.359+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-4109560623283999847
blogger_orig_url: https://jeremyko.blogspot.com/2020/04/redis-benchmark-rpsrequests-per-second.html
---

<p>redis-benchmark 를 수행했을때 출력되는 requests per second(RPS) 의미를 client 개수와 연관해보면 다음과 같다.  <br /></p><span><a name='more'></a></span><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border-width: 0.1em 0.1em 0.1em 0.8em; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">RPS = 전체 요청 명령 수 / client 가 나눠서 모두 처리한 시간  <br /></pre></div><br /><br />즉,&nbsp; 다음과 같이 백만건의 set 명령을 client 1 개가 수행하게 실행한 경우<br /><br /><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border-width: 0.1em 0.1em 0.1em 0.8em; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">redis-benchmark -d 70 -r 1000000 -n 1000000 -c <b>1</b> -t set<br /></pre></div><br />client 1 개가 백만번 set 을 수행해서 걸린 시간에 대한 rps 의미이며, 만약 client 2 개로 테스트 했다면<br /><br /><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border-width: 0.1em 0.1em 0.1em 0.8em; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">redis-benchmark -d 70 -r 1000000 -n 1000000 -c <b>2</b> -t set<br /></pre></div><br />client 2 개가 백만번의 set 명령을 나눠 수행하는데 걸린 시간에 대한 rps 의미이다 (이경우, client 별로 명령 처리가 정확하게 등분되지는 않기 때문에 정확하게 client당 50만개씩 수행되는것은 아니다).<br /><br />즉 요청한 전체 수행 건수를 client 들이 나눠서 모두 처리하는데 걸린 시간으로 rps 를 계산한다 (개인적으로 명확하게 알지 못했던 부분).&nbsp; <br /><br /><!--HTML generated using hilite.me--><br /><div style="background: rgb(255, 255, 255) none repeat scroll 0% 0%; border-width: 0.1em 0.1em 0.1em 0.8em; border: medium solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0px;">$ <span style="color: blue;">redis-benchmark -d 70 -r 1000000 -n 1000000 -c <b>1</b> -t set</span><br />====== SET ======<br />  1000000 requests completed in <span style="color: #cc0000;">62.08 seconds</span><br />  1 parallel clients<br />  70 bytes payload<br />  keep alive: 1<br /><br />100.00% &lt;= 1 milliseconds<br />100.00% &lt;= 2 milliseconds<br />100.00% &lt;= 2 milliseconds<br /><span style="color: #cc0000;">16107.73</span> requests per second<br /><br /><br />$ <span style="color: blue;">redis-benchmark -d 70 -r 1000000 -n 1000000 -c <b>2</b> -t set</span><br />====== SET ======<br />  1000000 requests completed in <span style="color: #cc0000;">26.71 seconds</span> <span style="color: #cc0000;">-&gt; 동일한 건수를 client가 나눠서 더 빨리 처리함</span></pre><pre style="line-height: 125%; margin: 0px;"><span style="color: #cc0000;">&nbsp;</span> 2 parallel clients<br />  70 bytes payload<br />  keep alive: 1<br /><br />100.00% &lt;= 1 milliseconds<br />100.00% &lt;= 1 milliseconds<br /><span style="color: #cc0000;">37443.37</span> requests per second <span style="color: #cc0000;">-&gt; RPS도 증가</span></pre><pre style="line-height: 125%; margin: 0px;">&nbsp;</pre></div><br />초당 처리 해야 할 명령 개수 목표치가 있다면, 이런 테스트를 통해서 client 가 대략 얼마나 필요할지 예상할수 있을 것이다. <br /><br />참고 : redis-5.0.8/src/redis-benchmark.c<br /><blockquote class="tr_bq"><br /></blockquote>