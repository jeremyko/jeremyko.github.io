---
layout: post
title: Ruby on Rails 간단 게시판 다시 만들어보기
date: '2012-09-03T16:04:00.004+09:00'
author: jeremyko
tags:
- Ruby on Rails
- 게시판
modified_time: '2012-09-21T11:46:13.644+09:00'
thumbnail: http://4.bp.blogspot.com/-AUu0y-9nlcM/UEW1T1IAb3I/AAAAAAAAA6E/L5k7mKkQBSw/s72-c/1.jpg
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-32924054166468967
blogger_orig_url: https://jeremyko.blogspot.com/2012/09/ruby-on-rails-rails.html
---

<br />예제 소스:&nbsp;<a href="https://github.com/jeremyko/RailsBoardSample/tree/moreRailsWay" target="_blank">https://github.com/jeremyko/RailsBoardSample/tree/moreRailsWay</a><br />참고한 문서 :&nbsp;<a href="http://ruby.railstutorial.org/ruby-on-rails-tutorial-book" target="_blank">http://ruby.railstutorial.org/ruby-on-rails-tutorial-book</a><br /><br />앞서 예제를 좀더 수정해서 약간 더 개선시킨 소스이다. 추가된 부분은 다음과 같다.<br /><br /><span style="color: #134f5c;"><b>1. RESTful routing</b></span><br /><span style="color: #134f5c;"><b>2. form_for , 모델을 폼과 연결</b></span><br /><span style="color: #134f5c;"><b>3. Partial 사용, 중복 제거</b></span><br /><b style="color: #134f5c;">4. Validation check</b><br /><b style="color: #134f5c;">5. bootstrap-sass</b><br /><br /><span style="color: #660000;"><b style="background-color: #fff2cc;">1. RESTful 제공</b></span><br /><br />rails가 제공하는 <a href="http://apidock.com/rails/ActionDispatch/Routing/Mapper/Resources/resources" target="_blank">resources 메서드</a>&nbsp;를 호출해서 RESTful한 route를 사용할수 있다.<br />route.rb 파일을 다음처럼 변경한다.<br /><br /><span style="background-color: #fff2cc;">* route.rb</span><br /><span style="color: #134f5c;">RailsBoard::Application.routes.draw do &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; root :to =&gt; 'my_rails_board_rows#index'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; #REST-style URI &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; <b>resources :my_rails_board_rows</b></span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; #matchs...</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; match '/listSpecificPageWork', &nbsp;to: 'my_rails_board_rows#listSpecificPageWork' &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; match '/searchWithSubject', &nbsp;to: 'my_rails_board_rows#searchWithSubject' &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; match '/EditViaPostReq', &nbsp;to: 'my_rails_board_rows#EditViaPostReq' &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">end</span><br /><br />이렇게 한줄 추가함으로서 rails에서 처리가능한 route는 다음처럼 구성되게 된다.<br /><br /><span style="color: #0b5394;">&lt; Table 1 RESTful URI &gt;</span><br /><span style="color: #134f5c;"># ------------------------------------------------------------------------------------</span><br /><span style="color: #134f5c;"># request &nbsp; &nbsp; URI &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Action &nbsp; &nbsp; &nbsp;Purpose</span><br /><span style="color: #134f5c;"># ------------------------------------------------------------------------------------</span><br /><span style="color: #134f5c;"># GET &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index &nbsp; &nbsp;모든 게시물들 조회</span><br /><span style="color: #134f5c;"># GET &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows/1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;show &nbsp; &nbsp; id 1의 게시물 조회</span><br /><span style="color: #134f5c;"># GET &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows/new &nbsp; &nbsp; &nbsp;new &nbsp; &nbsp; &nbsp; 새로운 게시물 작성을 위한 화면 보임</span><br /><span style="color: #134f5c;"># POST &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;create &nbsp; &nbsp;새로운 게시물을 생성 처리</span><br /><span style="color: #134f5c;"># GET &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows/1/edit &nbsp; edit &nbsp; &nbsp; &nbsp; &nbsp;id 1 게시물 수정을 위한 화면 보임</span><br /><span style="color: #134f5c;"># PUT &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows/1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;update &nbsp; id 1 게시물 수정 작업 처리</span><br /><span style="color: #134f5c;"># DELETE &nbsp; &nbsp;/my_rails_board_rows/1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destroy &nbsp;id 1 게시물 삭제 처리</span><br /><br />게시물 CRUD 처리를 RESTful하게 처리하기 때문에, 이전 예제와 비교시 action이 간단해졌다.&nbsp;또한 Rails는 url을 간단하게 표시할수 있게끔 helper를 같이 생성해주는데, resources :my_rails_board_rows 의 경우 다음과 같은 helper들이 생성된다.<br /><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><span style="color: #134f5c;">------------------------------------------------------------------------------------</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; helper &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;호출시 return 되는 값</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><span style="color: #134f5c;">------------------------------------------------------------------------------------</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; my_rails_board_rows_path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /my_rails_board_rows</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; new_my_rails_board_row_path &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/my_rails_board_rows/new</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; edit_my_rails_board_row_path(:id) &nbsp; &nbsp;/my_rails_board_rows/:id/edit</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; my_rails_board_row_path(:id) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /my_rails_board_rows/:id</span><br /><br />RESTful 구현을 위해 컨트롤러를 작성해보자<br />resources 호출로 &nbsp;RSESTful한 접근을 설정한 경우, Rails 는 위에서 표시된 것처럼(예를 들어, my_rails_board_rows/new), 모델명을 기준으로 컨트롤러를 찾게 된다. 즉, my_rails_board_rows_controller.rb를 찾는데, 현재 이 파일이 없으므로 생성해줘야 한다.<br /><br /><a name='more'></a><br /><br />rails g controller my_rails_board_rows 을 수행하거나, 직접 파일을 생성해도 된다.<br />그리고 다음처럼 코딩한다.<br /><br /><span style="background-color: #fff2cc;">* my_rails_board_rows_controller.rb</span><br /><br /><span style="color: #134f5c;">class MyRailsBoardRowsController &lt; ApplicationController</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; include ApplicationHelper</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; def index</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr = 'None'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @totalCnt = MyRailsBoardRow.all.count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @totalPageList = getTotalPageList( @totalCnt, rowsPerPage) &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @boardList =&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MyRailsBoardRow.find_by_sql ["select ID,SUBJECT,NAME, CREATED_AT, MAIL,MEMO,HITS \</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from MY_RAILS_BOARD_ROWS ORDER BY id desc limit %s offset 0", rowsPerPage ]&nbsp;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; render 'listSpecificPageWork'&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def show</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 내용보기 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @id = params[:id]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @current_page = params[:current_page]&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr= params[:searchStr] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # hits increase &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; MyRailsBoardRow.increment_counter(:hits, @id &nbsp;)</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @rowData = MyRailsBoardRow.find(params[:id])</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; render 'viewWork' &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def new</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 새로운 게시물 생성 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @rowData = MyRailsBoardRow.new&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; render 'show_write_form'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def create</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 글쓰기 등록 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @rowData = MyRailsBoardRow.new(params[:my_rails_board_row])</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; if @rowData.save &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; redirect_to '/'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; else</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; render 'show_write_form'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def update</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 변경내용을 저장 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @id = params[:id]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @current_page = params[:current_page]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr = params[:searchStr]&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # Update DataBase</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @rowData = MyRailsBoardRow.find(params[:id]) &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; if @rowData.update_attributes(params[:my_rails_board_row])</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Display Page =&gt; POST 요청은 redirection!</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url = '/listSpecificPageWork?current_page=' + @current_page+'&amp;searchStr='+@searchStr</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; redirect_to url &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; else</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; render 'update'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; end &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def destroy</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 게시물 삭제 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; MyRailsBoardRow.find(params[:id]).destroy</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; redirect_to my_rails_board_rows_path</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def&nbsp;EditAdditionalParams</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; # 내용 수정을 위해 내용 출력 구현</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @id = params[:id]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @current_page = params[:current_page]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr = params[:searchStr]&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @rowData = MyRailsBoardRow.find(params[:id])</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; render 'update'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; def searchWithSubject</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr = params[:searchStr] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; url = '/listSpecificPageWork?searchStr=' + @searchStr +'&amp;current_page=1'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; Rails.logger.debug "***** url:" + url</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; uri = URI.encode(url.strip) # 한글로 검색하는 경우를 위해, encode해준다. &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; Rails.logger.debug uri</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; redirect_to uri</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; def listSpecificPageWork</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @searchStr = URI.decode(params[:searchStr]) # 한글로 검색하는 경우를 위해, decode해준다. &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; Rails.logger.debug "listSpecificPageWork: @searchStr=" + @searchStr &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; @current_page = params[:current_page] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; Rails.logger.debug "!!! searchStr: #{@searchStr}" &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; if @searchStr == 'None'</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @totalCnt = MyRailsBoardRow.all.count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @totalPageList = getTotalPageList( @totalCnt, rowsPerPage)</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #sqlite3 &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @boardList =&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MyRailsBoardRow.find_by_sql ["select ID,SUBJECT,NAME, CREATED_AT, MAIL,MEMO,HITS \</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from MY_RAILS_BOARD_ROWS ORDER BY id desc limit %s offset %s",&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rowsPerPage, @current_page.to_i ==1 ? 0 : 2*(@current_page.to_i-1) ]&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; else</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 검색처리</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @totalCnt = MyRailsBoardRow.where("subject LIKE ?","%#{@searchStr}%").count()&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @totalPageList = getTotalPageList( @totalCnt, rowsPerPage)</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @boardList =&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MyRailsBoardRow.find_by_sql [</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "select ID,SUBJECT,NAME, CREATED_AT, MAIL,MEMO,HITS from MY_RAILS_BOARD_ROWS where subject like '%%%s%%' ORDER BY id desc</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;limit %s offset %s", @searchStr,rowsPerPage, @current_page.to_i ==1 ? 0 : 2*(@current_page.to_i-1) ]&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;end</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; end</span><br /><span style="color: #134f5c;">end</span><br /><br />이전 예제와 비교해서,&nbsp;RESTful 처리로 인해 이름이 변경되거나 삭제된 method 는&nbsp;다음과 같다.<br /><br /><span style="color: #134f5c;">show_write_form &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; new</span><br /><span style="color: #134f5c;">DoWriteBoard &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; create</span><br /><span style="color: #134f5c;">viewWork &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; show</span><br /><span style="color: #134f5c;">listSpecificPageWork_to_update &nbsp;=&gt; EditViaPostReq</span><br /><span style="color: #134f5c;">updateBoard &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; update</span><br /><span style="color: #134f5c;">DeleteSpecificRow &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; destroy</span><br /><span style="color: #134f5c;">listSearchedSpecificPageWork &nbsp; &nbsp;=&gt; 삭제됨,listSpecificPageWork로 통합</span><br /><br />다소 중복되었던 기능 통합을 위해 listSearchedSpecificPageWork 메서드는 listSpecificPageWork 로 통합되었다.&nbsp;이전 예제에서는 컨트롤러의 action 명에 맞는 view template 를 자동으로 찾아갈수 있게끔 처리했지만(rails 규칙), 이제 action명이 RESTful 한 것으로 변경되었으므로, render 를 이용해서 명시적으로 뷰를 지정해 준다. 그리고 이전 예제와 비교시 중요한 차이점은 새로운 게시물을 생성할때 모델을 생성해서 넘긴다는 점이다.&nbsp;즉, <span style="color: #134f5c;">@rowData = MyRailsBoardRow.new</span> 이부분이다. 이전 예제에서는 신규 작성 화면에서 넘겨준 내용을 컨트롤러에서 받아서 새로운 모델을 생성해서 저장했었다. 이 부분을 모델을 먼저 생성해서 뷰에 전달하고 돌려받는 식으로 처리할수 있게 변경한 것이다.<br /><br />그럼 새로운 글을 작성하기 위한 뷰를 정의해보자.<br />그전에 먼저 listSpecificPageWork.html.erb 파일 내용을 다음처럼 변경한다. 중복되던 소스를 통합한 소스이다.<br /><br />* listSpecificPageWork.html.erb<br /><br /><span style="color: #134f5c;">&lt;table cellspacing=1 width=700 border=0&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;총 게시물수: &lt;%=@totalCnt%&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;p align=right&gt; 페이지:&lt;%=@current_page%&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;table cellspacing=1 width=700 border=1&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=50&gt;&lt;p align=center&gt;번호&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;이름&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=320&gt;&lt;p align=center&gt;제목&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;등록일&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;조회수&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% if @boardList.any? %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;ul&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% &nbsp;@boardList.each do |boardRow| %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=50&gt;&lt;p align=center&gt;&lt;%=boardRow.id%&gt;&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;&lt;%=boardRow.name%&gt;&lt;/p&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=320&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p align=center&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a href="/my_rails_board_rows/&lt;%=boardRow.id%&gt;?current_page=&lt;%=@current_page%&gt;&amp;searchStr=&lt;%=@searchStr%&gt;" title="&lt;%=boardRow.memo%&gt;"&gt;&lt;%=boardRow.subject %&gt;&nbsp;</span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/p&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;&lt;%=boardRow.created_at%&gt;&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td width=100&gt;&lt;p align=center&gt;&lt;%=boardRow.hits%&gt;&lt;/p&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/ul&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;p&gt;No Data.&lt;/p&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;table cellspacing=1 width=700 border=1 &gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% &nbsp;@totalPageList.each do |page| %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;a href="/listSpecificPageWork?current_page=&lt;%=page%&gt;&amp;searchStr=&lt;%=@searchStr%&gt;" &gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% if page == @current_page.to_i %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;b&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;%=page%&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% if page == @current_page.to_i %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/b&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;% end %&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;% if @searchStr == 'None' %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;form name="searchf" method="post" action="/searchWithSubject/"&gt;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;table width=700&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tbody&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td valign="center"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p align="left"&gt;&lt;input class="btn btn-large btn-primary" value="글쓰기" onclick="window.location='/my_rails_board_rows/new'" &nbsp;type="button"&gt;&lt;/p&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td valign="right"&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p align="right"&gt;&lt;input name="searchStr" size="30" maxlength="50" type="text"&gt;&lt;/p&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td valign="center"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p align="right"&gt;&lt;input class="btn btn-large btn-primary" value="글찾기" type="submit"&gt;&lt;/p&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tbody&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/table&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/form&gt;</span><br /><span style="color: #134f5c;">&lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;table width=700&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;input type=button class="btn btn-large btn-primary" value="전체 목록으로 돌아가기" &nbsp;OnClick="window.location='/'" &gt; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/table&gt;</span><br /><span style="color: #134f5c;">&lt;% end %&gt;</span><br /><br /><span style="color: #999999;">&lt;a href="/my_rails_board_rows/&lt;%=boardRow.id%&gt;?...대신&nbsp;</span><span style="color: #999999;">link_to</span><span style="color: #999999;">&nbsp;를 사용해서&nbsp;</span><span style="color: #999999;">다음 처럼 써도 된다.</span><br /><span style="color: #999999;"><br /></span><span style="color: #999999;">&lt;%= link_to boardRow.subject, my_rails_board_row_path(:id =&gt; boardRow.id, :current_page=&gt;@current_page, :searchStr=&gt;@searchStr), :method =&gt; :get %&gt;</span><br /><br />별로 중요한 내용은 없고, 이전 예제에서 중복 소스를 통합한 것뿐이다.&nbsp;소스상에서 글작성을 위한 Action이 /my_rails_board_rows/new 인것을 확인할수 있을 것이다. 컨트롤러에서는 new액션이 호출되고, show_write_form 뷰가 호출되게 된다. 이제 글작성을 위해 뷰를 수정해보자. show_write_form.html.erb 파일이 이미 존재할것이다. 이 내용을 다음처럼 변경한다.<br /><br />* show_write_form.html.erb<br /><br /><span style="color: #134f5c;">&lt;% provide(:title, '게시판 글쓰기') %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;table cellspacing = 0 cellpadding = 5 border = 1 width=500&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &lt;%= form_for(@rowData) do |f| %&gt; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- 여기서부터: 공통적으로 사용이 될법한 부분 --&gt;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :name %&gt;&lt;/b&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :name %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :mail %&gt;&lt;/b&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :mail %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :subject %&gt;&lt;/b&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :subject %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :memo %&gt;&lt;/b&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_area :memo %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- 여기까지: 공통적으로 사용이 될법한 부분 --&gt;&nbsp;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;table width="150"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;%= f.submit "등록", class: "btn btn-large btn-primary" %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/table&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><br /><b style="background-color: #fff2cc; color: #660000;">2. form_for</b><br /><b style="background-color: #fff2cc; color: #660000;"><br /></b>이전 예제에서는 직접 form을 구성하는 부분이 있었지만 이제는, 모델(Active Record)의 속성을 가지고 자동적으로 입력폼을 만들어주는 <b><span style="background-color: #fff2cc; color: #134f5c;">form_for helper method</span></b>를 사용했다. 즉 다음의 코드는 실제 html에서는 다음으로 변환된다.<br /><br /><span style="color: #134f5c;">&lt;%= f.label :name %&gt;</span><br /><span style="color: #134f5c;">&lt;%= f.text_field :name %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">------&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;label for="my_rails_board_row_name"&gt;Name&lt;/label&gt;</span><br /><span style="color: #134f5c;">&lt;input id="my_rails_board_row_name" name="my_rails_board_row[name]" size="30" type="text" /&gt;</span><br /><br />또한 form_for는 새로운 form을 생성하게 되는데, 실제 생성되는 html 소스는 다음과 같다.<br /><span style="color: #134f5c;">&lt;form accept-charset="UTF-8" action="/my_rails_board_rows" class="new_my_rails_board_row" id="new_my_rails_board_row" method="post"&gt;</span><br /><br /><span style="background-color: #fff2cc;">흥미로운 점은 Rails가 판단해서 새로운 글 작성시 필요한 URI, method 를 설정해 줬다는 점이다</span>. 즉, 현재 이 뷰가 호출되게 만든 actin은 GET방식- /my_rails_board_rows/new action 이었다. 그리고 글작성 뷰에서 form 이 처리하는 action은 Rails에 의해 POST 방식- /my_rails_board_rows 액션으로 설정 되었다. 이 결과로 RESTful하게 호출되는것은 create action이 될것이다 ( Table 1 RESTful URI 에서처럼). RESTful하게 처리되게끔 Rails 가 자동으로 생성을 해었다.<br /><br />그럼 다시 글작성 뷰 소스로 돌아가 보자. 곰곰 생각해보니 글 작성과 조회, 수정시에 공통적으로 사용이 될만한 부분이 보인다. 바로 이부분들이다.<br /><span style="color: #134f5c;">&lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :name %&gt;&lt;/b&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :name %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&lt;/tr&gt;</span><br /><span style="color: #134f5c;">...&nbsp;</span><br /><br /><b style="background-color: #fff2cc; color: #660000;">3. partial</b><br /><b style="background-color: #fff2cc; color: #660000;"><br /></b>rails에서는 중복되는 뷰를 공통적으로 사용할수 있게끔 <b><span style="color: #134f5c;">partial</span></b> 을 사용할수 있다.<br />위 소스를 다음처럼 수정한다.<br /><br /><span style="color: #134f5c;">&lt;% provide(:title, '게시판 글쓰기') %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;table cellspacing = 0 cellpadding = 5 border = 1 width=500&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &lt;%= form_for(@rowData) do |f| %&gt; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;%= render 'shared/error_messages' %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% @readOnlyFlag = 0 %&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;%= render :partial =&gt; "rowDataInput", :locals =&gt; { :f =&gt; f , :readOnlyFlag =&gt; @readOnlyFlag } %&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;table width="150"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;%= f.submit "등록", class: "btn btn-large btn-primary" %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/table&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><br />rowDataInput 이라는 <span style="background-color: #fff2cc;">partial을 사용해서 중복없이 소스를 관리할수 있다</span>. 이를 위해서는 '_' 로 시작되는 partial 파일을 생성해야 한다.&nbsp;즉, _rowDataInput.html.erb 파일이다.<br /><br />* \RailsBoard\app\views\my_rails_board_rows\_rowDataInput.html.erb<br /><br />&nbsp; &nbsp; <span style="color: #134f5c;">&lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :name %&gt;&lt;/b&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% if @readOnlyFlag == 1 %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :name,:readonly =&gt; true %&gt;&lt;br /&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :name %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :mail %&gt;&lt;/b&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% if @readOnlyFlag == 1 %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :mail,:readonly =&gt; true %&gt;&lt;br /&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :mail %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :subject %&gt;&lt;/b&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% if @readOnlyFlag == 1 %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :subject,:readonly =&gt; true %&gt;&lt;br /&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_field :subject %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;b&gt;&lt;%= f.label :memo %&gt;&lt;/b&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% if @readOnlyFlag == 1 %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_area :memo,:readonly =&gt; true %&gt;&lt;br /&gt;&lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% else %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= f.text_area :memo %&gt;&lt;br /&gt;&lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% end %&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span><br />&nbsp; <br />약간 수정된 부분이 있다. readOnlyFlag 을 partial에 전달하는 목적은 글작성, 조회, 변경시에 수정가능 여부를 조정하기 위한 목적이다.<br />그런데 &lt;%= render 'shared/error_messages' %&gt; 이부분은 무었인가?<br /><br /><b><span style="background-color: #fff2cc; color: #660000;">4. Validation&nbsp;</span></b><br /><br />이것은 입력 유효성 체크를 위해서 사용되었다. rails에서 입력 유효성을 체크하기 위해서는 모델에 validates 호출을 추가해야한다.<br />\Ruby_Dev\RailsBoard\app\models\my_rails_board_row.rb 파일을 다음처럼 수정한다.<br /><br /><span style="color: #134f5c;">class MyRailsBoardRow &lt; ActiveRecord::Base</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; attr_accessible :hits, :mail, :memo, :name, :subject</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; # 유효성 체크&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; before_save { |rowData| rowData.mail = mail.downcase }</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; validates :name, &nbsp;presence: true, length: { maximum: 50 }</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; validates :subject, &nbsp;presence: true, length: { maximum: 50 }</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; validates :mail, presence: true, format: { with: VALID_EMAIL_REGEX }</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; validates :memo, &nbsp;presence: true, length: { maximum: 200 }</span><br /><span style="color: #134f5c;">end</span><br /><br />무엇을 의미하는지는 바로 알수 있을것 같다.<br />presence: true -&gt; 설정해서 반드시 입력해야하는 값임을 설정하는것이다. 이메일 입력의 경우 유효한 이메일 주소인지 판단시 정규식을 이용할수 있다. 이제 error_messages partial 을 생성한다.<br /><br />\RailsBoard\app\views\shared\_error_messages.html.erb<br /><br /><span style="color: #134f5c;">&lt;% if @rowData.errors.any? %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &lt;div id="error_explanation"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;div class="alert alert-error"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; The form contains &lt;%= pluralize(@rowData.errors.count, "error") %&gt;.</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/div&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;ul&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% @rowData.errors.full_messages.each do |msg| %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/ul&gt;</span><br /><span style="color: #134f5c;">&nbsp; &lt;/div&gt;</span><br /><span style="color: #134f5c;">&lt;% end %&gt;</span><br />이 partial이 하는 일은 모델에 에러가 있는 경우 모든 에러에 대한 상세 메시지를 화면에 출력해 주는 것이다.<br /><br /><b><span style="background-color: #fff2cc; color: #660000;">5. bootstrap-sass</span></b><br /><br />이전 예제에서 아무런 CSS처리없이 화면 처리가 되었는데, 이제 약간 화면 디자인을 고려해서 CSS를 적용해보자. bootstrap-sass gem을 설치해서 사용해 보려 한다. Gemfile에 gem 'bootstrap-sass', '2.0.4' 을 추가한다.<br /><br /><span style="color: #134f5c;">source 'https://rubygems.org'</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">gem 'rails', '3.2.8'</span><br /><span style="color: #134f5c;">gem 'sqlite3', '1.3.5'</span><br /><span style="color: #134f5c;"><b>gem 'bootstrap-sass', '2.0.4'</b></span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;"># gem 'ruby-oci8'</span><br /><span style="color: #134f5c;"># gem 'activerecord-oracle_enhanced-adapter'</span><br /><span style="color: #134f5c;">group :assets do</span><br /><span style="color: #134f5c;">&nbsp; gem 'sass-rails', &nbsp; '~&gt; 3.2.3'</span><br /><span style="color: #134f5c;">&nbsp; gem 'coffee-rails', '~&gt; 3.2.1' &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; gem 'uglifier', '&gt;= 1.0.3' &nbsp;</span><br /><span style="color: #134f5c;">end</span><br /><span style="color: #134f5c;">gem 'jquery-rails'</span><br /><br />그리고 bundle install 을 수행해서 설치한다.<br />그다음 해야 할일은 app/assets/stylesheets/custom.css.scss 파일을 생성하는것이다.<br /><br /><span style="color: #134f5c;">* custom.css.scss</span><br /><br /><span style="color: #134f5c;">@import "bootstrap";</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">$grayMediumLight: #eaeaea;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">html {</span><br /><span style="color: #134f5c;">&nbsp; overflow-y: scroll;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">body {</span><br /><span style="color: #134f5c;">&nbsp; padding-top: 60px;</span><br /><span style="color: #134f5c;">&nbsp; background-color:$grayMediumLight; &nbsp;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">section {</span><br /><span style="color: #134f5c;">&nbsp; overflow: auto;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">.center {</span><br /><span style="color: #134f5c;">&nbsp; text-align: center;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">.center h1 {</span><br /><span style="color: #134f5c;">&nbsp; margin-bottom: 10px;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">@mixin box_sizing {</span><br /><span style="color: #134f5c;">&nbsp; -moz-box-sizing: border-box;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; -webkit-box-sizing: border-box;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; box-sizing: border-box;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">/* forms */</span><br /><span style="color: #134f5c;">textarea</span><br /><span style="color: #134f5c;">{</span><br /><span style="color: #134f5c;">&nbsp; border: 1px solid #bbb;</span><br /><span style="color: #134f5c;">&nbsp; width: 100%;</span><br /><span style="color: #134f5c;">&nbsp; padding: 5px;</span><br /><span style="color: #134f5c;">&nbsp; height: 100px;</span><br /><span style="color: #134f5c;">&nbsp; margin-bottom: 5px;</span><br /><span style="color: #134f5c;">&nbsp; @include box_sizing;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; resize: vertical; &nbsp;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">input</span><br /><span style="color: #134f5c;">{</span><br /><span style="color: #134f5c;">&nbsp; border: 1px solid #bbb;</span><br /><span style="color: #134f5c;">&nbsp; width: 100%;</span><br /><span style="color: #134f5c;">&nbsp; padding: 5px;</span><br /><span style="color: #134f5c;">&nbsp; height: auto;</span><br /><span style="color: #134f5c;">&nbsp; margin-bottom: 5px;</span><br /><span style="color: #134f5c;">&nbsp; @include box_sizing; &nbsp;</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">#error_explanation</span><br /><span style="color: #134f5c;">{</span><br /><span style="color: #134f5c;">&nbsp; color: #f00;</span><br /><span style="color: #134f5c;">&nbsp; ul {</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; list-style: none;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; margin: 0 0 5px 0;</span><br /><span style="color: #134f5c;">&nbsp; }</span><br /><span style="color: #134f5c;">}</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">.field_with_errors&nbsp;</span><br /><span style="color: #134f5c;">{</span><br /><span style="color: #134f5c;">&nbsp; @extend .control-group;</span><br /><span style="color: #134f5c;">&nbsp; @extend .error; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">}</span><br /><br />여기까지 작업후, 테스트를 해본다. 서버를 기동시킨후, <a href="http://localhost:3000/" target="_blank">http://localhost:3000</a> 로 가보면 화면이 약간 이쁘게 변한것을 볼수 있을것이다.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-AUu0y-9nlcM/UEW1T1IAb3I/AAAAAAAAA6E/L5k7mKkQBSw/s1600/1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="131" src="http://4.bp.blogspot.com/-AUu0y-9nlcM/UEW1T1IAb3I/AAAAAAAAA6E/L5k7mKkQBSw/s320/1.jpg" width="320" /></a></div><br />아까 만든 유효성 체크를 위해 글작성 화면으로 가서, 아무 내용없이 등록 버튼을 눌러 보자.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-QrvR6b2IKlE/UEW1UiRK5UI/AAAAAAAAA6I/jZ1sBxe6Elc/s1600/2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="253" src="http://1.bp.blogspot.com/-QrvR6b2IKlE/UEW1UiRK5UI/AAAAAAAAA6I/jZ1sBxe6Elc/s320/2.jpg" width="320" /></a></div><br />다음 처럼 상세 에러메시지가 보이게 된다.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-gnsXO6hwXpY/UEW1VZpeRVI/AAAAAAAAA6Q/H5hf64uXRUk/s1600/3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-gnsXO6hwXpY/UEW1VZpeRVI/AAAAAAAAA6Q/H5hf64uXRUk/s320/3.jpg" width="245" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">정상적으로 입력후 등록 버튼을 누르면 저장이 될것이다.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both;">이제 글 조회를 위한 기능을 처리해보자. 메인 뷰에서 글 제목을 선택시, 소스 코드상에는 다음 link로 이동하게 처리하고 있다.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;a href="/my_rails_board_rows/&lt;%=boardRow.id%&gt;?current_page=&lt;%=@current_page%&gt;&amp;searchStr=&lt;%=@searchStr%&gt;" title="&lt;%=boardRow.memo%&gt;"&gt;&lt;%=boardRow.subject %&gt;&nbsp;</span></div><div class="separator" style="clear: both;">혹은 다음처럼 작성해도 무방.</div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;%= link_to boardRow.subject, my_rails_board_row_path(:id =&gt; boardRow.id, :current_page=&gt;@current_page, :searchStr=&gt;@searchStr), :method =&gt; :get %&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">GET방식, /my_rails_board_rows/글id 로 처리되므로, RESTful 처리에 의해, show 액션이 호출될것이다.</div><div class="separator" style="clear: both;">게시물 보기를 위한 뷰, viewWork 를 작성해보자.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;"><span style="background-color: #fff2cc;">* viewWork.html.erb</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;% provide(:title, '글보기'+@rowData.name) %&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;table cellspacing = 0 cellpadding = 5 border = 1 width=500&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &lt;%= form_for(@rowData) do |f| %&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% @readOnlyFlag = 1 %&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;%= render :partial =&gt; "rowDataInput", :locals =&gt; { :f =&gt; f , :readOnlyFlag =&gt; @readOnlyFlag } %&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt; &nbsp; &nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;/table&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;table width="150"&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &lt;tr&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= button_to '수정' , {:action =&gt; "<b>EditAdditionalParams</b>", :id =&gt; @id, :current_page =&gt; @current_page, :searchStr =&gt; @searchStr} ,class: "btn btn-large btn-primary" %&gt;&lt;/td&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= button_to &nbsp;"삭제", my_rails_board_row_path(:current_page =&gt; @current_page, :searchStr =&gt; @searchStr),class: "btn btn-large btn-primary", :confirm =&gt; 'Are you sure?', :method=&gt; :delete %&gt;&lt;/td&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;&lt;%= button_to '목록' , {:action =&gt; "listSpecificPageWork", :current_page =&gt; @current_page, :searchStr =&gt; @searchStr} ,class: "btn btn-large btn-primary" %&gt;&lt;/td&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&nbsp; &nbsp; &lt;/tr&gt;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;/table&gt;&nbsp;</span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;">글 수정을 위해서 <a href="http://apidock.com/rails/ActionView/Helpers/UrlHelper/button_to" target="_blank">button_to</a> 를 사용해서&nbsp;EditAdditionalParams 액션을 호출하고 있다.&nbsp;그런데 RESTful 구현을 위해서는 edit action을 호출해 줘야 할것 같은데 왜 EditAdditionalParams action을 사용하고 있는가? 이것은 edit 처리시, id 뿐 아니라, current_page, searchStr의 정보도 같이 전달해줘야 하는데, RESTful edit를 처리시에는 이러한 추가적인 parameter들을 전달할 방법을 찾을 수 없어서 이렇게 구현을 하였다. 즉 만약, 위에 수정 부분을 다음과 같이 변경한다면,</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;%= button_to &nbsp;"수정", edit_my_rails_board_row_path(:id =&gt; @id), class: "btn btn-large btn-primary", :method=&gt; :get &nbsp;%&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">이결과로 만들어진 html소스를 보면 다음과 같다.&nbsp;</div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;form action="/my_rails_board_rows/8/edit" class="button_to" method="get"&gt;&lt;div&gt;&lt;input class="btn btn-large btn-primary" type="submit" value="수정" /&gt;&lt;/div&gt;&lt;/form&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">RESTful edit가 호출은 되는데 추가로 전달해줘야할 parameter 정보가 누락되게 된다. 그래서 혹시나 하고 다음처럼 해보면,&nbsp;</div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;%= button_to &nbsp;"수정", edit_my_rails_board_row_path(:id =&gt; @id, :current_page=&gt; @current_page, :searchStr =&gt; @searchStr), class: "btn btn-large btn-primary" %&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">html소스는 다음처럼 만들어지는데,</div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;form action="/my_rails_board_rows/41/edit?current_page=1&amp;amp;searchStr=None" class="button_to" method="post"&gt;&lt;div&gt;&lt;input class="btn btn-large btn-primary" type="submit" value="수정" /&gt;&lt;input name="authenticity_token" type="hidden" value="bczaTatv1RFdtg8bsyrQ5RUELi1bobZhD7ZZAWjj6Dk=" /&gt;&lt;/div&gt;&lt;/form&gt;</span></div><div class="separator" style="clear: both;">화면에서 클릭시에는 다음과 같은 오류가 발생한다.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;"><span style="color: #660000;"><u>No route matches [POST] "/my_rails_board_rows/41/edit"</u></span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">즉, RESTful 한 edit를 위해서는 Post방식이 아니라 Get방식을 사용해야 함을 나타낸다. button_to 는 기본적으로 post 를 사용하기 때문이다.&nbsp;그래서 다음처럼 method를 get으로 설정하고 다시 호출해보면,&nbsp;</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;%= button_to &nbsp;"수정", edit_my_rails_board_row_path(:id =&gt; @id, :current_page=&gt; @current_page, :searchStr =&gt; @searchStr), class: "btn btn-large btn-primary",:method=&gt; :get %&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">html소스는 다음처럼 만들어지는데,</div><div class="separator" style="clear: both;"><span style="color: #134f5c;"><br /></span></div><div class="separator" style="clear: both;"><span style="color: #134f5c;">&lt;td&gt;&lt;form action="/my_rails_board_rows/41/edit?current_page=1&amp;amp;searchStr=None" class="button_to" method="get"&gt;&lt;div&gt;&lt;input class="btn btn-large btn-primary" type="submit" value="수정3" /&gt;&lt;/div&gt;&lt;/form&gt;</span></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">보다시피 form action이 RESTful edit 경로에 추가적인 정보를 덧붙인 것으로 만들어져 버리기 때문에, 나머지 current_page, searchStr 정보는 제대로 전달이 되지 않았다.&nbsp;</div><div class="separator" style="clear: both;">button_to 사용을 안하고 직접 form 을 만들어서 hidden field 로 처리하면 가능할것이지만 그냥 RESTful routing은 사용안하는것으로 하고, 새로운 EditAdditionalParams action을 만들어서 button_to를 사용해서 GET방식으로 호출하였다. button_to 를 사용해서 RESTful edit path를 호출하면서 id 이외의 인자들을 전달하는 방법은 어떻게 하면 될지..? 아마 내가 알지 못하는 방법이 있을지도 모르겠다. &nbsp;</div><br /><span style="background-color: #fff2cc;">정리 해서 말하자면...</span>:<br />- button_to 를 사용하면 결국 form 이 만들어지기 때문에 id 이외의 추가 정보를 전송하려면 Post방식을 사용해야만 한다.<br />- 그런데&nbsp;RESTful edit 처리는 Get방식으로만 처리해야 한다.<br />- button_to 와 Get방식을 사용하면 RESTful edit URI로 추가적인 인자를 전송할수 없다.<br />- 만약 form 을 생성하지 않는 link_to 를 사용한다면&nbsp;RESTful edit URI 를 사용&nbsp;할수 있다.<br /><br /><span style="color: #134f5c;">&lt;td&gt;&lt;%= link_to "수정", {:action =&gt; 'edit',:id =&gt; @id, :current_page =&gt; @current_page, :searchStr =&gt; @searchStr }, class: "btn btn-large btn-primary" %&gt;&lt;/td&gt;</span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-nOHagMBSFU8/UEa-rXMDK0I/AAAAAAAAA6o/qwhBQP-j7_s/s1600/4.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="238" src="http://1.bp.blogspot.com/-nOHagMBSFU8/UEa-rXMDK0I/AAAAAAAAA6o/qwhBQP-j7_s/s320/4.jpg" width="320" /></a></div><br /><br />그럼 글수정을 위한 뷰를 살펴보도록 하자. update.html.erb 파일을 생성하고 다음처럼 수정한다.<br /><br /><span style="background-color: #fff2cc;">* update.html.erb</span><br /><br /><span style="color: #134f5c;">&lt;% provide(:title, '글 수정'+@rowData.name) %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&lt;table cellspacing = 0 cellpadding = 5 border = 1 width=500&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &lt;%= form_for(@rowData) do |f| %&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;input type=hidden name=id &nbsp;value="&lt;%=@id%&gt;"&gt; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;input type=hidden name=current_page &nbsp;value="&lt;%=@current_page%&gt;"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;input type=hidden name=searchStr &nbsp;value="&lt;%=@searchStr%&gt;"&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;%= render 'shared/error_messages' %&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;% @readOnlyFlag = 0 %&gt; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;%= render :partial =&gt; "rowDataInput", :locals =&gt; { :f =&gt; f , :readOnlyFlag =&gt; @readOnlyFlag } %&gt;</span><br /><span style="color: #134f5c;"><br /></span><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;table width="150"&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;%= f.submit "재등록", class: "btn btn-large btn-primary" %&gt;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;%= button_to &nbsp;"목록", {:action =&gt; "listSpecificPageWork", :current_page =&gt; @current_page, :searchStr =&gt; @searchStr} ,class: "btn btn-large btn-primary" %&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt; &nbsp; &nbsp; &nbsp; &nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &nbsp; &nbsp; &lt;/table&gt;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp;&nbsp;</span><br /><span style="color: #134f5c;">&nbsp; &nbsp; &lt;% end %&gt;</span><br /><span style="color: #134f5c;">&lt;/table&gt;</span><br /><br />글 수정을 위한 RESTful uri 는 다음처럼 되어야 함을 앞서의 표에서 확인할수 있을 것이다.<br /><br /><span style="color: #134f5c;">PUT &nbsp; &nbsp; &nbsp; /my_rails_board_rows/1 &nbsp; &nbsp; &nbsp;update &nbsp; id 1 게시물 수정 작업 처리</span><br /><br />그럼 rails form_for를 사용했을때, 실제 html로 변환된 부분에서 이것을 확인해 보도록 하자.<br /><br /><span style="color: #134f5c;">&lt;form accept-charset="UTF-8" action="/my_rails_board_rows/43" class="edit_my_rails_board_row" id="edit_my_rails_board_row_43" method="post"&gt;&lt;div style="margin:0;padding:0;display:inline"&gt;&lt;input name="utf8" type="hidden" value="&amp;#x2713;" /&gt;&lt;input name="_method" type="hidden" value="put" /&gt;...</span><br /><br />앞서의 delete와 마찬가지로 PUT 요청을 바로 처리할수 없기 때문에 폼의 hidden field를 만들어서 전달하고 있음을 알수 있다. 또한 글 작성 때와 마찬가지로&nbsp;form 처리시&nbsp;rails에 의해 적합한 action으로 처리되고 있음도 알수 있다.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-WUbIVd11Sqs/UEa-1hMpvoI/AAAAAAAAA6w/Ijr1L4Sqmgo/s1600/5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="238" src="http://4.bp.blogspot.com/-WUbIVd11Sqs/UEa-1hMpvoI/AAAAAAAAA6w/Ijr1L4Sqmgo/s320/5.jpg" width="320" /></a></div><br />이제 기본적인 글작성, 수정, 삭제, 조회, 목록 조회기능이 구현되었다.<br /><div><br /></div>