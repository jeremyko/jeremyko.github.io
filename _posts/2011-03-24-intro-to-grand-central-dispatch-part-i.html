---
layout: post
title: 'Intro to Grand Central Dispatch, Part I: Basics and Dispatch Queues 정리'
date: '2011-03-24T17:59:00.000+09:00'
author: jeremyko
tags:
- ios
- GCD
- iphone
modified_time: '2015-09-20T12:30:47.023+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-5830516710995925346
blogger_orig_url: https://jeremyko.blogspot.com/2011/03/intro-to-grand-central-dispatch-part-i.html
---

<br /><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">참고 :&nbsp;<a href="http://www.mikeash.com/pyblog/friday-qa-2009-08-28-intro-to-grand-central-dispatch-part-i-basics-and-dispatch-queues.html" style="color: #909090; text-decoration: none;" target="_blank">www.mikeash.com</a></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">향후 아이패드2나 아이폰5 등 멀티코어 환경에서 개발을 하려는&nbsp;</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">사람들에게는</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">꼭 알아두어야 할&nbsp;</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">기술이&nbsp;</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">바로 이 GCD 가 아닐까 한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><div style="font-family: Tahoma, arial, helvetica, sans-serif;"><b><i>* 2011-10-20에 추가됨</i></b></div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">이번에 IOS5 가 나오면서 GCD 에 변경된 부분이 있다.</div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">간추려보면</div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">1. 새로운 global queue 추가(DISPATCH_QUEUE_PRIORITY_BACKGROUND)</div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">2. custom concurrent queue</div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">3. Dispatch IO</div><div style="font-family: Tahoma, arial, helvetica, sans-serif;">자세한 사항은&nbsp;<a href="http://www.mikeash.com/pyblog/friday-qa-2011-10-14-whats-new-in-gcd.html" style="color: #909090; text-decoration: none;" target="_blank"><b>여기</b></a>를 참조</div></div><div style="background-color: white; color: #555555; font-family: Tahoma, arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><br /></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">1. GCD (Grand Central Dispatch)</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">concurrent programming을 위한 저수준 C API.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">작업을 분리하고 work queues에 저장후, 동시에 혹은 하나씩 작업을 처리.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">(NSOperationQueue와 비슷하나 좀더 저수준이고 높은 성능을 보인다고 한다).</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">dispatch object = &nbsp;GCD 는 객체지향 개념으로 만들어졌다. GCD 객체를 일컬음.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">메모리 관리 필요 : dispatch_retain, dispatch_release</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">Dispatch Queues: 처리할 작업을 받아들이기 위한 객체. concurrent / serial 이 존재.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">동시에 작업을 처리(시스템 부하를 고려하여)하거나 하나씩 작업을 처리한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">3가지 큐 존재</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">Main queue: serial queue.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>메인 쓰레드가 처리하게 된다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>dispatch_get_main_queue() 호출로 얻을수있다.&nbsp;<span class="Apple-tab-span" style="white-space: pre;">    </span></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">Global queues: concurrent queues</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>전체 프로세스가 공유하며, 3종류 존재</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>(high,default,low priority queue).</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>동시에 작업을 수행한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>dispatch_get_global_queue() 호출로 접근가능 (priority 지정필요).</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">Custom queues: serial queue.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>한번에 하나씩 작업을 처리한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;">  </span>dispatch_queue_create()로 생성된다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">2.<span class="Apple-tab-span" style="white-space: pre;"> </span>사용법</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span class="Apple-tab-span" style="white-space: pre;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"> </span></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; 1) 큐를 생성 (위의 함수 호출 이용)</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">custom queue 경우 다음처럼 호출.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;">dispatch_queue_create(<span class="string string_quoted string_quoted_double string_quoted_double_c" style="background-color: #fff0f0; color: #dd2200;">"com.yourcompany.subsystem.task"</span>, <span class="constant constant_language constant_language_c" style="color: #003388; font-weight: bold;">NULL</span>);<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500485.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500485" style="color: #336699; text-decoration: none;">Pastie #2500485</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; 2) 처리할 작업을 전달한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span></span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;">dispatch_async(dispatch_get_global_queue<br />  (DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="constant constant_numeric constant_numeric_c" style="color: #0000dd; font-weight: bold;">0</span>),<br /> ^{<br />  <span class="meta meta_bracketed meta_bracketed_objc">[<span class="variable variable_language variable_language_objc" style="color: #003388; font-weight: bold;">self</span> <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">goDoSomethingLongAndInvolved</span></span>]</span>;<br />  <span class="support support_function support_function_cocoa" style="color: #cc0000; font-weight: bold;">NSLog</span>(<span class="string string_quoted string_quoted_double string_quoted_double_objc" style="background-color: #fff0f0; color: #dd2200;">@"Done doing something long and involved"</span>);<br /> });<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500430.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500430" style="color: #336699; text-decoration: none;">Pastie #2500430</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span><span style="font-family: Tahoma, arial, helvetica, sans-serif; white-space: pre;">  </span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>dispatch_async 함수는 즉시 리턴되며, 작업은 비동기적으로</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>백그라운드에서 수행된다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>* 중첩된 dispatche.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>시간이 걸리는 작업 종료후 UI변경등이 필요한 경우</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>UI처리는 main thread 에서 수행되어야 하므로 중첩된 호출을 통해 가능함.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; &nbsp; &nbsp; &nbsp;</span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;">dispatch_async(dispatch_get_global_queue<br />  (DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="constant constant_numeric constant_numeric_c" style="color: #0000dd; font-weight: bold;">0</span>),<br />^{<br /> <span class="meta meta_bracketed meta_bracketed_objc">[<span class="variable variable_language variable_language_objc" style="color: #003388; font-weight: bold;">self</span> <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">goDoSomethingLongAndInvolved</span></span>]</span>;<br />     dispatch_async(dispatch_get_main_queue(),<br />     ^{<br />            <span class="meta meta_bracketed meta_bracketed_objc">[textField <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">setStringValue:</span><span class="string string_quoted string_quoted_double string_quoted_double_objc" style="background-color: #fff0f0; color: #dd2200;">@"Done doing something long and involved"</span></span>]</span>;<br />        });<br />});<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500436.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500436" style="color: #336699; text-decoration: none;">Pastie #2500436</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>처리할 작업(block)이 종료될때까지 기다리는 경우 dispatch_sync 사용.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span class="Apple-tab-span" style="white-space: pre;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">  </span></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>__block 변수 : 살행중인 block으로부터 결과를 받을수 있음. 만약 백그라운드</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>작업중인 쓰레드에서 GUI 컴트롤 값을 필요로 하는 경우 다음처럼 사용가능.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; &nbsp; &nbsp; &nbsp;</span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">//백그라운드 쓰레드내에서의 소스.</span><br /><span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">//현재 이쓰레드가 백그라운드로 작업중이라고 가정.</span><br />__block <span class="support support_class support_class_cocoa" style="color: #003366; font-weight: bold;">NSString</span> *stringValue;<br />  <br />dispatch_sync(dispatch_get_main_queue(),<br />^{<br />        <span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">// __block 변수는 자동으로 retain 되지 않음.</span><br />        <span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">// reference 를 확실하게 만들어서 관리한다.</span><br />        stringValue = <span class="meta meta_bracketed meta_bracketed_objc">[<span class="meta meta_bracketed meta_bracketed_objc">[textField <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">stringValue</span></span>]</span> <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">copy</span></span>]</span>;<br />});<br />  <br /><span class="meta meta_bracketed meta_bracketed_objc">[stringValue <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">autorelease</span></span>]</span>;  <br /><span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">// 그리고 stringValue를 백그라운드 쓰레드에서 사용한다.</span><br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500450.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500450" style="color: #336699; text-decoration: none;">Pastie #2500450</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><br /></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>쓰레드등을 이용한 백그라운드 프로세싱을 중첩된 block을 이용하여 아래처럼</span><span style="font-family: Tahoma, arial, helvetica, sans-serif; white-space: pre;"> </span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">교체가능하다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;">dispatch_queue_t bgQueue = myQueue; <span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">//global 혹은 custom 큐.</span><br /><br />dispatch_async(dispatch_get_main_queue(), ^{<br />    <span class="support support_class support_class_cocoa" style="color: #003366; font-weight: bold;">NSString</span> *stringValue = <span class="meta meta_bracketed meta_bracketed_objc">[<span class="meta meta_bracketed meta_bracketed_objc">[<span class="meta meta_bracketed meta_bracketed_objc">[textField <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">stringValue</span></span>]</span> <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">copy</span></span>]</span> <span class="meta meta_function-call meta_function-call_objc"><span class="support support_function support_function_any-method support_function_any-method_objc" style="color: #cc0000; font-weight: bold;">autorelease</span></span>]</span>;<br />    dispatch_async(bgQueue, ^{<br />            <span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">// 이부분에 들어가는 소스는 백그라운드로 수행되며</span><br />            <span class="comment comment_line comment_line_double-slash comment_line_double-slash_c++" style="color: #888888;">// stringValue 를 사용할수 있다.</span><br />    });<br />});<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500459.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500459" style="color: #336699; text-decoration: none;">Pastie #2500459</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;3) Lock을 대체하기 위해서 이렇게도 사용 가능하다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;&nbsp; &nbsp; &nbsp;일반적인 경우가 다음과 같다면,</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; &nbsp;</span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><span class="variable variable_other variable_other_constant variable_other_constant_ruby" style="color: #003366; font-weight: bold;">NSLock</span> <span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_ruby" style="color: black;">*</span>lock;  <br /><span class="string string_regexp string_regexp_classic string_regexp_classic_ruby" style="background-color: #fff0ff; color: #880088;">/</span><span class="string string_regexp string_regexp_classic string_regexp_classic_ruby" style="background-color: #fff0ff; color: #880088;">/</span>getter<br /><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_ruby" style="color: black;">-</span> (id)something<br />{<br />    id localSomething;<br />    [lock lock];<br />    localSomething <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby" style="color: black;">=</span> [[something retain] autorelease];<br />    [lock unlock];<br />    <span class="keyword keyword_control keyword_control_pseudo-method keyword_control_pseudo-method_ruby" style="color: #008800; font-weight: bold;">return</span> localSomething;<br />}<br /><span class="string string_regexp string_regexp_classic string_regexp_classic_ruby" style="background-color: #fff0ff; color: #880088;">/</span><span class="string string_regexp string_regexp_classic string_regexp_classic_ruby" style="background-color: #fff0ff; color: #880088;">/se</span>tter<br /><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_ruby" style="color: black;">-</span> (void)<span class="constant constant_other constant_other_symbol constant_other_symbol_ruby constant_other_symbol_ruby_19syntax" style="color: #aa6600;">setSomething:</span>(id)newSomething<br />{<br />    [lock lock];<br />    <span class="keyword keyword_control keyword_control_ruby" style="color: #008800; font-weight: bold;">if</span>(newSomething <span class="keyword keyword_operator keyword_operator_comparison keyword_operator_comparison_ruby" style="color: black;">!=</span> something)<br />    {<br />        [something release];<br />        something <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby" style="color: black;">=</span> [newSomething retain];<br />        [<span class="variable variable_language variable_language_ruby" style="color: #003388; font-weight: bold;">self</span> updateSomethingCaches];<br />    }<br />    [lock unlock];<br />}<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500472.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500472" style="color: #336699; text-decoration: none;">Pastie #2500472</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; &nbsp;</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>다음처럼 바꿀수 있다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span>이때 큐는 custom (즉 serial)큐만 가능하다. 동기 /비동기 처리를</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>활용하는것임.&nbsp;</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">즉 , 비동기(dispatch_async)로 동기화가 필요한 함수를</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>호출하면</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; 백그라운드에서는 dispatch_sync로 처리되어 serial하게</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>작업을 처리한다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp; &nbsp;<span class="Apple-tab-span" style="white-space: pre;"> </span></span><br /><div class="pastie"><div class="allcode" style="border-bottom-color: rgb(221, 221, 221); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(221, 221, 221); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(221, 221, 221); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(221, 221, 221); border-top-style: solid; border-top-width: 1px; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-bottom: 5px; padding-left: 10px; padding-right: 10px; padding-top: 5px;"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source-numbers" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #999999; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace; padding-right: 12px;">1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br /></pre></td><td style="color: #555555; font-family: 돋움, Dotum; font-size: 12px; line-height: 18px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><pre class="textmate-source" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><pre class="sunburst" style="background-attachment: initial; background-clip: initial; background-color: transparent; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; font-family: 'Bitstream Vera Sans Mono', Monaco, Consolas, 'Courier New', monospace;"><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_ruby" style="color: black;">-</span> (id)something<br />{<br />    __block id localSomething;<br />    dispatch_sync(queue, <span class="keyword keyword_operator keyword_operator_logical keyword_operator_logical_ruby" style="color: black;">^</span>{<br />         localSomething <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby" style="color: black;">=</span> [something retain];<br />    });<br />    <span class="keyword keyword_control keyword_control_pseudo-method keyword_control_pseudo-method_ruby" style="color: #008800; font-weight: bold;">return</span> [localSomething autorelease];<br />}<br />    <br /><span class="keyword keyword_operator keyword_operator_arithmetic keyword_operator_arithmetic_ruby" style="color: black;">-</span> (void)<span class="constant constant_other constant_other_symbol constant_other_symbol_ruby constant_other_symbol_ruby_19syntax" style="color: #aa6600;">setSomething:</span>(id)newSomething<br />{<br />    dispatch_async(queue, <span class="keyword keyword_operator keyword_operator_logical keyword_operator_logical_ruby" style="color: black;">^</span>{<br />        <span class="keyword keyword_control keyword_control_ruby" style="color: #008800; font-weight: bold;">if</span>(newSomething <span class="keyword keyword_operator keyword_operator_comparison keyword_operator_comparison_ruby" style="color: black;">!=</span> something)<br />        {<br />            [something release];<br />            something <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby" style="color: black;">=</span> [newSomething retain];<br />            [<span class="variable variable_language variable_language_ruby" style="color: #003388; font-weight: bold;">self</span> updateSomethingCaches];<br />        }<br />    });<br />}<br /></pre></pre></td></tr></tbody></table></div><div class="credit" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-color: rgb(204, 204, 204); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 1px; border-right-color: rgb(204, 204, 204); border-right-style: solid; border-right-width: 1px; border-top-color: initial; border-top-style: initial; border-top-width: 0px; color: #666666; font-family: 'Lucida Grande', Arial, Helvetica, sans-serif; font-size: 0.7em; padding-bottom: 7px; padding-left: 15px; padding-right: 15px; padding-top: 7px;"><div class="buttons" style="float: right; margin-top: -3px;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/pastes/2500480.txt" style="color: #336699; text-decoration: none;"><img src="http://pastie.org/images/view.png" height="20" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;" width="67" /></a></span></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><a href="http://pastie.org/2500480" style="color: #336699; text-decoration: none;">Pastie #2500480</a>&nbsp;linked directly from&nbsp;<a href="http://pastie.org/" style="color: #336699; text-decoration: none;">Pastie</a>.</span></div></div><span style="font-family: Tahoma, arial, helvetica, sans-serif;"></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><span class="Apple-tab-span" style="white-space: pre;"> </span>dispatch queue 사용이 매우 가벼워서 lock을 거는 빈도가 많아도 무방함.</span><span style="font-family: Tahoma, arial, helvetica, sans-serif;">&nbsp;</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Tahoma, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><b><span style="color: #d41a01; font-family: Tahoma, arial, helvetica, sans-serif;"><b></b></span></b><br /><div style="color: black; font-weight: normal;"><b><span style="color: #d41a01; font-family: Tahoma, arial, helvetica, sans-serif;"><b>더욱 온전한 내용을 원하신다면 원문을 참조하기 바랍니다...</b></span></b></div><b><span style="color: #d41a01; font-family: Tahoma, arial, helvetica, sans-serif;"><b></b></span></b></div>