---
layout: post
title: 'close(0) 로 인한 stdin close : getline, getchars 동작 이상'
date: '2017-02-10T00:43:00.001+09:00'
author: jeremyko
tags:
- 삽질기록
modified_time: '2017-02-13T21:12:00.992+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-3988169717043903330
blogger_orig_url: https://jeremyko.blogspot.com/2017/02/close0-stdin-close-getline-getchars.html
---

왜 getline() 함수가 즉시 리턴되는가? 에 대한 삽질의 기억...<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #204a87; font-weight: bold;">class</span> <span style="color: black;">SomeClass</span><br /><span style="color: black; font-weight: bold;">{</span><br />    <span style="color: black; font-weight: bold;">...</span><br />    <span style="color: black;">int nSockFd_</span>  <span style="color: black; font-weight: bold;">{</span><span style="color: #0000cf; font-weight: bold;">0</span><span style="color: black; font-weight: bold;">};</span> <span style="color: #8f5902; font-style: italic;">//초기화를 0 으로 한 경우.</span><br />    <span style="color: black; font-weight: bold;">...</span><br /><span style="color: black; font-weight: bold;">};</span>     <br /><br /><span style="color: #204a87; font-weight: bold;">void</span> <span style="color: black;">SomeClass</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">SomeMethod1</span><span style="color: black; font-weight: bold;">()</span><br /><span style="color: black; font-weight: bold;">{</span><br />    <span style="color: black; font-weight: bold;">....</span> <br />    <span style="color: #8f5902; font-style: italic;">//코드 어딘가에서 다음을 호출했는데... 아직 nSockFd_ 가 할당안된 경우 </span><br />    <span style="color: black;">close</span><span style="color: black; font-weight: bold;">(</span><span style="color: black;">nSockFd_</span><span style="color: black; font-weight: bold;">);</span> <span style="color: #8f5902; font-style: italic;">//--&gt; close(0) --&gt; stdin 을 닫아버림 - - ;;</span><br />    <span style="color: black; font-weight: bold;">...</span> <br /><span style="color: black; font-weight: bold;">}</span><br /><br /><span style="color: #204a87; font-weight: bold;">void</span> <span style="color: black;">SomeClass</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">SomeMethod2</span><span style="color: black; font-weight: bold;">()</span><br /><span style="color: black; font-weight: bold;">{</span>&nbsp;</pre><pre style="line-height: 125%; margin: 0;">   .... &nbsp;</pre><pre style="line-height: 125%; margin: 0;">&nbsp;  <span style="color: black;">std</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">string</span> <span style="color: black;">line</span><span style="color: #ce5c00; font-weight: bold;">=</span><span style="color: #4e9a06;">""</span><span style="color: black; font-weight: bold;">;</span><br />    <span style="color: #204a87; font-weight: bold;">while</span><span style="color: black; font-weight: bold;">(</span><span style="color: #204a87;">true</span><span style="color: black; font-weight: bold;">)</span><br />    <span style="color: black; font-weight: bold;">{</span>  <br />        <span style="color: black;">std</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">cin</span><span style="color: black; font-weight: bold;">.</span><span style="color: black;">clear</span><span style="color: black; font-weight: bold;">();</span><br />        <span style="color: black;">getline</span><span style="color: black; font-weight: bold;">(</span><span style="color: black;">std</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">cin</span><span style="color: black; font-weight: bold;">,</span> <span style="color: black;">line</span><span style="color: black; font-weight: bold;">);</span> <span style="color: #8f5902; font-style: italic;">//여기서 문제 발생, 즉시 리턴됨</span><br />        <span style="color: black;">std</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">cout</span> <span style="color: #ce5c00; font-weight: bold;">&lt;&lt;</span> <span style="color: #4e9a06;">"msg:"</span> <span style="color: #ce5c00; font-weight: bold;">&lt;&lt;</span> <span style="color: black;">line</span> <span style="color: #ce5c00; font-weight: bold;">&lt;&lt;</span> <span style="color: black;">std</span><span style="color: #ce5c00; font-weight: bold;">::</span><span style="color: black;">endl</span><span style="color: black; font-weight: bold;">;</span><br />    <span style="color: black; font-weight: bold;">}</span><br /><span style="color: black; font-weight: bold;">}</span><br /></pre></div><br />