---
layout: post
title: sizeWithFont오류
date: '2011-05-30T17:54:00.000+09:00'
author: jeremyko
tags:
- sizeWithFont
- iphone
modified_time: '2012-04-04T17:54:56.261+09:00'
blogger_id: tag:blogger.com,1999:blog-7360229670252766698.post-1791814448166401290
blogger_orig_url: https://jeremyko.blogspot.com/2011/05/sizewithfont.html
---

<br /><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">UITextView 기존내용을 사용자가 터치한 경우, 편집상태로 만들면서</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">커서를 보이면서 화면을 보이게끔 스크롤이 필요하다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">처음부터 터치된 곳까지의 문자열을 계산해서, 그 문장이 차지하는 높이를 구하면</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">UIScrollView의 scrollRectToVisible 를 이용해서 커서위치를 보이게 만들어주면 된다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">그런데 이 위치, 즉 전체화면에서 현재 터치한 부분의 좌표값을 얻어오는데 문제가 있었다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">일단 첫번째 방법은 NSString 의 sizeWithFont:constrainedToSize:lineBreakMode 사용이다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">대부분의 경우에 이것을 사용하면 되지만, 이상하게도 이것은 아주 긴 내용이거나,</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">폰트를 변경함에 따라서 정확한 값을 얻을수 없다. 아래의 방법을 이용해서 사용하는</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">예는 많이 찾아 볼수있었지만 직접 테스트 해보면 정확한 값을 가져오지 못해서 커서가</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">화면 아래나 위로 숨어버리는 문제가 발생했다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><br /></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><div class="embedPastebin" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-style: none; border-color: initial; border-color: initial; border-image: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; border-width: initial; color: black; font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><div class="embedFooter" style="background-attachment: initial; background-clip: initial; background-color: #cccccc; background-image: initial; background-origin: initial; padding-bottom: 0px; padding-left: 6px; padding-right: 6px; padding-top: 0px;">Data provided by&nbsp;<a href="http://pastebin.com/" style="color: blue; text-decoration: none;">Pastebin.com</a>&nbsp;-&nbsp;<a href="http://pastebin.com/raw.php?i=76KExRR7" style="color: blue; text-decoration: none;" target="_top">Download Raw</a></div><div class="objc"><ol><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">CGSize maximumTextViewSize&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;CGSizeMake<span class="br0" style="color: #002200;">(</span><span class="nu0" style="color: #2400d9;">320</span><span class="sy0" style="color: #002200;">-</span>&nbsp;<span class="nu0" style="color: #2400d9;">30</span>&nbsp;,<span class="kw2" style="color: #a61390;">FLT_MAX</span><span class="br0" style="color: #002200;">)</span>;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// 게다가 좌우 여백을 줘야 그나마 비슷하게 구해진다!</span></div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">CGSize expectedLabelSize&nbsp;<span class="sy0" style="color: #002200;">=</span><span class="br0" style="color: #002200;">[</span>strToCursor &nbsp;sizeWithFont<span class="sy0" style="color: #002200;">:</span>self.currentTextView.font</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; constrainedToSize<span class="sy0" style="color: #002200;">:</span>maximumTextViewSize</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lineBreakMode<span class="sy0" style="color: #002200;">:</span>UILineBreakModeWordWrap<span class="br0" style="color: #002200;">]</span>;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">DLog<span class="br0" style="color: #002200;">(</span><span class="co3" style="color: #bf1d1a;">@</span><span class="st0" style="color: #bf1d1a;">"expectedLabelSize height [%f]"</span>, expectedLabelSize.height<span class="br0" style="color: #002200;">)</span>;&nbsp;<span class="co2" style="color: #11740a; font-style: italic;">//sometimes wrong height !!</span></div></li></ol></div></div></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><br /></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">두번째는...</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">이건 뭔 API 를 써야 될찌 감도 안와서 궁리하다가 적용한 원시적인 방법으로(방법이라고 할 수도 없을듯...),</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">UITextView 의 contentSize.height 가 실제로 텍스트를 가지고 있는 UITextView가 차지하는</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">높이이므로, 이 높이를 가지고 처리하는 방법이다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">그럴려면 먼저 임시 UITextView를 만들고,내용을 채우고, apple 내부에서 무슨 논리로</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">처리했는지는 모르겠지만 암튼 텍스트에 맞게 적절히 설정된 높이를 얻어와서 그 좌표를 가지고</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;">스크롤 시켜주면, 커서 위치가 키보드 출력이후에도 사용자에게 보이게끔 잘 설정된다.</span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;"><br /></span></div><div style="background-color: white; color: #555555; font-family: arial, helvetica, sans-serif; font-size: 12px; line-height: 18px; text-align: left;"><span style="font-family: Verdana, arial, helvetica, sans-serif;"><div class="embedPastebin" style="background-attachment: initial; background-clip: initial; background-color: #eeeeee; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; border-bottom-style: none; border-color: initial; border-color: initial; border-image: initial; border-left-style: none; border-right-style: none; border-top-style: none; border-width: initial; border-width: initial; color: black; font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><div class="embedFooter" style="background-attachment: initial; background-clip: initial; background-color: #cccccc; background-image: initial; background-origin: initial; padding-bottom: 0px; padding-left: 6px; padding-right: 6px; padding-top: 0px;">Data provided by&nbsp;<a href="http://pastebin.com/" style="color: blue; text-decoration: none;">Pastebin.com</a>&nbsp;-&nbsp;<a href="http://pastebin.com/raw.php?i=CSHf7zUa" style="color: blue; text-decoration: none;" target="_top">Download Raw</a></div><div class="objc"><ol><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// kinda primitive way - - ;;;</span></div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// 전역으로 UITextView변수를 만들고</span></div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// gTextViewforHeightCalculate에 텍스트를 붙여넣고, 실제 높이를 구한다.</span></div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// API이용해서 정확하게 가져올수만 있다면 이짓을 할필요는 없을건데...</span></div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">CGRect viewFrame&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="br0" style="color: #002200;">[</span>gTextViewforHeightCalculate frame<span class="br0" style="color: #002200;">]</span>; &nbsp; &nbsp;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">viewFrame.size.height&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;CGFLOAT_MAX &nbsp;;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">gTextViewforHeightCalculate.frame&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;viewFrame;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">gTextViewforHeightCalculate.minNumberOfLines&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="nu0" style="color: #2400d9;">1</span>; &nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">gTextViewforHeightCalculate.returnKeyType&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;UIReturnKeyDefault;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">gTextViewforHeightCalculate.font&nbsp;<span class="sy0" style="color: #002200;">=</span><span class="br0" style="color: #002200;">[</span>UIFont fontWithName<span class="sy0" style="color: #002200;">:</span>self.cur_font size<span class="sy0" style="color: #002200;">:</span>&nbsp;<span class="br0" style="color: #002200;">[</span>self.cur_font_size intValue<span class="br0" style="color: #002200;">]</span><span class="br0" style="color: #002200;">]</span>;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">//커서 이전까지의 문자열</span></div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="kw4" style="color: #a61390;">NSRange</span>&nbsp;tmpRange; &nbsp; &nbsp; &nbsp;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">tmpRange.location<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="nu0" style="color: #2400d9;">0</span>;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">tmpRange.length&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;&nbsp;self.currentTextView.selectedRange.location ;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="kw5" style="color: #400080;">NSString</span><span class="sy0" style="color: #002200;">*</span>&nbsp;strToCursor&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;&nbsp;<span class="br0" style="color: #002200;">[</span>self.currentTextView.text substringWithRange<span class="sy0" style="color: #002200;">:</span>&nbsp;tmpRange<span class="br0" style="color: #002200;">]</span>&nbsp;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">gTextViewforHeightCalculate.text&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;strToCursor ;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="kw4" style="color: #a61390;">float</span>&nbsp;nHeight&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;gTextViewforHeightCalculate.contentSize.height;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">DLog<span class="br0" style="color: #002200;">(</span><span class="co3" style="color: #bf1d1a;">@</span><span class="st0" style="color: #bf1d1a;">"UITextView height [%f]"</span>, nHeight<span class="br0" style="color: #002200;">)</span>; &nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="co2" style="color: #11740a; font-style: italic;">// 커서 위치만큼 scroll</span></div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">CGRect cgView;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">cgView.origin.x&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="nu0" style="color: #2400d9;">0.0</span>;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">cgView.origin.y&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;self.currentTextView.frame.origin.y&nbsp;<span class="sy0" style="color: #002200;">+</span>&nbsp;nHeight;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">cgView.size.width&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="nu0" style="color: #2400d9;">320</span>;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">cgView.size.height&nbsp;<span class="sy0" style="color: #002200;">=</span>&nbsp;<span class="nu0" style="color: #2400d9;">40</span>;</div></li><li class="li1" style="background-attachment: initial; background-clip: initial; background-color: white; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de1" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;">&nbsp; &nbsp; &nbsp; &nbsp;</div></li><li class="li2" style="background-attachment: initial; background-clip: initial; background-color: #f8f8f8; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial;"><div class="de2" style="background-attachment: initial; background-clip: initial; background-color: initial; background-image: none; background-origin: initial; font-size: 1em; line-height: 1.2em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: top;"><span class="br0" style="color: #002200;">[</span>self.scrollView scrollRectToVisible<span class="sy0" style="color: #002200;">:</span>cgView animated<span class="sy0" style="color: #002200;">:</span>TRUE<span class="br0" style="color: #002200;">]</span>;</div></li></ol></div></div></span></div>